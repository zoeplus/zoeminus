
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Stat/">
      
      
        <link rel="next" href="../DSA/">
      
      
      <link rel="icon" href="../../imgs/zxr.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.16">
    
    
      
        <title>最优化理论 - zoeminus</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      

  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 7v2h4l-4 6v2h6v-2h-4l4-6V7H9m3-5a10 10 0 0 1 10 10 10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2Z"/></svg>');}</style>


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="amber" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="zoeminus" class="md-header__button md-logo" aria-label="zoeminus" data-md-component="logo">
      
  <img src="../../imgs/zx.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            zoeminus
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              最优化理论
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="amber" data-md-color-accent="amber"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/zoeplus/zoeminus" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    zoeminus
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="zoeminus" class="md-nav__button md-logo" aria-label="zoeminus" data-md-component="logo">
      
  <img src="../../imgs/zx.png" alt="logo">

    </a>
    zoeminus
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zoeplus/zoeminus" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    zoeminus
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    主页
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    一
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            一
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Set/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    集合论
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../R/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    实数理论
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数学分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LAlg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    高等代数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../GTopo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    一般拓扑学
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    实变函数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MAlg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    矩阵代数
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    九
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            九
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Prob/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    概率论
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Stat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数理统计
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    最优化理论
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    最优化理论
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="本文组织：">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      本文组织：
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      依赖和简介
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      凸集和凸函数
    </span>
  </a>
  
    <nav class="md-nav" aria-label="凸集和凸函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      凸集
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      凸函数
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      线性规划
    </span>
  </a>
  
    <nav class="md-nav" aria-label="线性规划">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      单纯形算法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="单纯形算法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      修正单纯形算法：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      两阶段法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#m" class="md-nav__link">
    <span class="md-ellipsis">
      M 法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      对偶单纯性法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      整数线性规划
    </span>
  </a>
  
    <nav class="md-nav" aria-label="整数线性规划">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      分枝界定法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gemory" class="md-nav__link">
    <span class="md-ellipsis">
      Gemory 割平面法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      无约束优化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="无约束优化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      线性搜索
    </span>
  </a>
  
    <nav class="md-nav" aria-label="线性搜索">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      线性搜索准则
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      黄金分割法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      精确线性搜索
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      多元无约束优化问题
    </span>
  </a>
  
    <nav class="md-nav" aria-label="多元无约束优化问题">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      最速下降法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newton" class="md-nav__link">
    <span class="md-ellipsis">
      Newton 迭代法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      共轭梯度法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newton_1" class="md-nav__link">
    <span class="md-ellipsis">
      拟 Newton 法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="拟 Newton 法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dfr" class="md-nav__link">
    <span class="md-ellipsis">
      DFR 算法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      信赖域方法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="信赖域方法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      信赖域算法收敛性分析
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      无约束问题测试函数
    </span>
  </a>
  
    <nav class="md-nav" aria-label="无约束问题测试函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rosenbrock" class="md-nav__link">
    <span class="md-ellipsis">
      Rosenbrock
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      立方体函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      三角函数
    </span>
  </a>
  
    <nav class="md-nav" aria-label="三角函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rosenbrock-n2" class="md-nav__link">
    <span class="md-ellipsis">
      求解 Rosenbrock, 立方体函数, 三角函数（ \(n=2\) 情形）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      信赖域算法求解
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newton_2" class="md-nav__link">
    <span class="md-ellipsis">
      拟 Newton 法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      约束优化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="约束优化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lagrange" class="md-nav__link">
    <span class="md-ellipsis">
      Lagrange 对偶问题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kt" class="md-nav__link">
    <span class="md-ellipsis">
      KT 算法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      罚函数法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      障碍罚函数法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      二次规划
    </span>
  </a>
  
    <nav class="md-nav" aria-label="二次规划">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      等式约束二次规划问题
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DSA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数据结构与算法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CLT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    计算学习理论
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    二十二
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            二十二
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数据挖掘
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    统计学习
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    深度学习
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    二十
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            二十
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SageMath/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SageMath
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Coding/C.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Coding/CPP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C++
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Coding/Python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    十九
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            十九
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Cookbooks/DLCB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Cookbooks/PyDCB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python DM & ML
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    零零五五
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            零零五五
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Parrot/Divisadero/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    遥望
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Parrot/Relate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    溶
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Parrot/Different.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    异
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Parrot/Falling.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    落
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Parrot/LucidDreaming.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    清醒的梦
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Parrot/WithLLM.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    对话
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7" >
        
          
          <label class="md-nav__link" for="__nav_7_7" id="__nav_7_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    存在主义
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_7">
            <span class="md-nav__icon md-icon"></span>
            存在主义
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Parrot/Existential/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    存在 I
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Parrot/B%26N/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    对存在的追求
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="本文组织：">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      本文组织：
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      依赖和简介
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      凸集和凸函数
    </span>
  </a>
  
    <nav class="md-nav" aria-label="凸集和凸函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      凸集
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      凸函数
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      线性规划
    </span>
  </a>
  
    <nav class="md-nav" aria-label="线性规划">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      单纯形算法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="单纯形算法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      修正单纯形算法：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      两阶段法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#m" class="md-nav__link">
    <span class="md-ellipsis">
      M 法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      对偶单纯性法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      整数线性规划
    </span>
  </a>
  
    <nav class="md-nav" aria-label="整数线性规划">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      分枝界定法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gemory" class="md-nav__link">
    <span class="md-ellipsis">
      Gemory 割平面法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      无约束优化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="无约束优化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      线性搜索
    </span>
  </a>
  
    <nav class="md-nav" aria-label="线性搜索">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      线性搜索准则
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      黄金分割法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      精确线性搜索
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      多元无约束优化问题
    </span>
  </a>
  
    <nav class="md-nav" aria-label="多元无约束优化问题">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      最速下降法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newton" class="md-nav__link">
    <span class="md-ellipsis">
      Newton 迭代法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      共轭梯度法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newton_1" class="md-nav__link">
    <span class="md-ellipsis">
      拟 Newton 法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="拟 Newton 法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dfr" class="md-nav__link">
    <span class="md-ellipsis">
      DFR 算法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      信赖域方法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="信赖域方法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      信赖域算法收敛性分析
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      无约束问题测试函数
    </span>
  </a>
  
    <nav class="md-nav" aria-label="无约束问题测试函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rosenbrock" class="md-nav__link">
    <span class="md-ellipsis">
      Rosenbrock
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      立方体函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      三角函数
    </span>
  </a>
  
    <nav class="md-nav" aria-label="三角函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rosenbrock-n2" class="md-nav__link">
    <span class="md-ellipsis">
      求解 Rosenbrock, 立方体函数, 三角函数（ \(n=2\) 情形）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      信赖域算法求解
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newton_2" class="md-nav__link">
    <span class="md-ellipsis">
      拟 Newton 法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      约束优化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="约束优化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lagrange" class="md-nav__link">
    <span class="md-ellipsis">
      Lagrange 对偶问题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kt" class="md-nav__link">
    <span class="md-ellipsis">
      KT 算法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      罚函数法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      障碍罚函数法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      二次规划
    </span>
  </a>
  
    <nav class="md-nav" aria-label="二次规划">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      等式约束二次规划问题
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/zoeplus/zoeminus/commits/main/docs/Math/Opt.md" title="编辑此页" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  


  <h1>最优化理论</h1>

<h2 id="_1">依赖和简介<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>对于范数和矩阵理论的<a href="../MAlg/#范数">介绍</a>.</p>
<p>最优化方法主要分为两个步骤：<strong>优化建模</strong>和<strong>求解</strong>. 优化建模与特定的专业领域有关，本篇专述求解（算法）.</p>
<p>最优化方法的分类：<strong>离散</strong> &amp; <strong>连续</strong>；<strong>有限维</strong> &amp; <strong>无限维</strong>. 本篇主要考虑的是 <span class="arithmatex">\(\mathbb{R}^n\)</span> 上的连续有限维优化. 首先介绍<a href="#凸集和凸函数">#凸集和凸函数</a>，并说明凸优化问题的性质：局部最优解即为全局最优解；随后处理<a href="#线性规划">#线性规划</a>问题，介绍<a href="#单纯形算法">#单纯形算法</a>及其变种；现实中处理的很多线性规划问题都是<a href="#整数线性规划">#整数线性规划</a>，对于该问题主要介绍 <a href="#gemory-割平面法">#Gemory 割平面法</a>. 之后进入到两个重要问题：<a href="#无约束优化">#无约束优化</a>和<a href="#约束优化">#约束优化</a>. 无约束优化从可以分为两个部分，一种是确定优化方向 <span class="arithmatex">\(d_k\)</span> 后确定优化步长 <span class="arithmatex">\(\alpha_k\)</span> 的迭代法： <a href="#最速下降法">#最速下降法</a>、<a href="#newton-迭代法">#Newton 迭代法</a>、<a href="#拟-newton-法">#拟 Newton 法</a>，另一种是将 <span class="arithmatex">\(\alpha_k d_k\)</span> 视为一个整体求解： <a href="#信赖域方法">#信赖域方法</a>，此外对于求步长的问题提出了各种准则和方法，见<a href="#线性搜索">#线性搜索</a>. 对于约束优化问题，与无约束优化问题的区别在于求解出的优化步长可能不在可行域内. 对此提出了 <a href="#kt-算法">#KT 算法</a>（KKT 算法）、<a href="#罚函数法">#罚函数法</a>、<a href="#障碍罚函数法">#障碍罚函数法</a>.</p>
<p>下面介绍一些术语.</p>
<p>对于 <span class="arithmatex">\(\mathbb{R}^n\)</span> 中的优化问题. 通常记<strong>标准内积</strong> <span class="arithmatex">\(x,y\in \mathbb{R}^n,\langle x,y \rangle=\sum\limits_{i=1}^{n}x_iy_i\)</span> ，给定一个<a href="../LAlg/#正定矩阵">正定</a>对称矩阵 <span class="arithmatex">\(P\)</span> ，记 <span class="arithmatex">\(\langle x,y \rangle_P=x^TPy\)</span> . 并可以定义<strong>矩阵内积</strong> <span class="arithmatex">\(A,B\in \mathbb{R}^{m\times n}, \langle A,B \rangle=\sum\limits_{i=1}^{m}\sum\limits_{j=1}^{n}a_{ij}b_{ij}=\text{tr}(A^TB)=\text{tr}(B^TA)\)</span> .</p>
<p>符号说明：</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="arithmatex">\(d_k\)</span></td>
<td>第 <span class="arithmatex">\(k\)</span> 步的下降方向</td>
</tr>
<tr>
<td><span class="arithmatex">\(g_k\)</span></td>
<td>若 <span class="arithmatex">\(f\)</span> 可微，用 <span class="arithmatex">\(g_k\)</span> 表示 <span class="arithmatex">\(\nabla f(x_k)\)</span></td>
</tr>
<tr>
<td><span class="arithmatex">\(\alpha_k\)</span></td>
<td>第 <span class="arithmatex">\(k\)</span> 步的优化步长</td>
</tr>
<tr>
<td><span class="arithmatex">\(\varphi_k(\alpha)\)</span></td>
<td><span class="arithmatex">\(\varphi_k(\alpha)=f(x_k+\alpha d_k)\)</span></td>
</tr>
<tr>
<td><span class="arithmatex">\(\rho,c\)</span></td>
<td>两种符号都使用，用于表示一些超参数</td>
</tr>
<tr>
<td><span class="arithmatex">\(c_i(x)\)</span></td>
<td>第 <span class="arithmatex">\(i\)</span> 个约束条件</td>
</tr>
</tbody>
</table>
<p>连续优化的形式为： </p>
<div class="arithmatex">\[\begin{aligned}
&amp;\min_{x} f(x)\\
&amp;s.t.\left\{\begin{aligned}
&amp;c_i(x)=0,i=1,\cdots,m\\
&amp;c_j(x)\geq0,j=m+1,\cdots,p
\end{aligned}\right.
\end{aligned}\]</div>
<p>其中 <span class="arithmatex">\(c_i,i=1,\cdots,n\)</span> 为连续函数. 称 <span class="arithmatex">\(c_i(x)=0\)</span> 为<strong>等式约束</strong>， <span class="arithmatex">\(c_j(x)\geq0\)</span> 为<strong>不等式约束</strong>. 定义<strong>可行集</strong>： </p>
<div class="arithmatex">\[F=\{x:c_i(x)=0,i=1,\cdots,m,c_j(x)\geq0,j=m+1,\cdots,p\}\]</div>
<p>对于任意 <span class="arithmatex">\(x\in F\)</span> ，定义<strong>指标集合</strong>： </p>
<div class="arithmatex">\[\mathcal{A}(x)=\{1,2,\cdots ,n\}\backslash \{k:c_k(x)&gt;0\}=\{1,\cdots,m\}\cup\{k:c_k(x)\leq 0\}\]</div>
<p>为 <span class="arithmatex">\(x\)</span> 的<strong>积极约束</strong>， <span class="arithmatex">\(\{1,2,\cdots,n\}\backslash \mathcal{A}(x)\)</span> 称为 <span class="arithmatex">\(x\)</span> 的<strong>非积极约束</strong>. （此处的积极，指的是对于 <span class="arithmatex">\(x\)</span> 进行轻微绕动之后是否影响约束条件，一般来说对于 <span class="arithmatex">\(c_{i}(x)&gt;0\)</span> 约束，不会产生变化，因此称为非积极）. </p>
<p>定义<strong>整体最优解</strong> <span class="arithmatex">\(x^*\)</span> ： <span class="arithmatex">\(\forall x\in F,f(x^*)\leq f(x)\)</span> ；定义<strong>严格整体最优解</strong> <span class="arithmatex">\(x^*\)</span> ： <span class="arithmatex">\(\forall x\in F,x\neq x^*,f(x^*)&lt;f(x)\)</span> . <strong>局部最优解</strong>：对于 <span class="arithmatex">\(x^*\)</span> ，存在某一邻域 <span class="arithmatex">\(N\)</span> ， <span class="arithmatex">\(\forall x\in N\cap F,x\neq x^*,f(x^*)\leq f(x)\)</span> ，<strong>严格局部最优解</strong>类似.</p>
<p>按照可行集可以将优化问题划分为<strong>凸优化</strong>和<strong>非凸优化</strong>，多数情况下凸优化简单，因为凸优化情形下局部最优即为整体最优.</p>
<h2 id="_2">凸集和凸函数<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<div class="admonition abstract">
<p class="admonition-title">自查表</p>
<ul>
<li>凸集、凸组合、凸包定义；</li>
</ul>
</div>
<h3 id="_3">凸集<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>凸优化中的可行集是<strong>凸集</strong>：对于 <span class="arithmatex">\(D\subset \mathbb{R}^n\)</span> ，称 <span class="arithmatex">\(D\)</span> 为凸集，如果 <span class="arithmatex">\(\forall x,y\in D,\forall \lambda\in(0,1)\)</span> ， <span class="arithmatex">\(\lambda x+(1-\lambda)y\in D\)</span> . 定义<strong>凸组合</strong>：对于 <span class="arithmatex">\(x_i\in \mathbb{R}^n\)</span> ， <span class="arithmatex">\(\alpha_i\in \mathbb{R}^n,\alpha_i&gt;0,\sum\limits_{i=1}^{m}\alpha_i=1\)</span> ， <span class="arithmatex">\(,i=1,\cdots,m\)</span> ，称 <span class="arithmatex">\(\sum\limits_{i=1}^{m}\alpha_ix_i\)</span> 为 <span class="arithmatex">\(x_1,\cdots,x_m\)</span> 的凸组合. 定义<strong>凸包</strong>： <span class="arithmatex">\(D\subset \mathbb{R}^n\)</span> ，称 <span class="arithmatex">\(H(D)=\{D\text{ 中有限多个点的凸组合}\}\)</span> 为 <span class="arithmatex">\(D\)</span> 的凸包，或者记为 <span class="arithmatex">\(\text{conv}\ D\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">凸组合中 <span class="arithmatex">\(\alpha_i&gt;0\)</span> ，而不是 <span class="arithmatex">\(\geq\)</span> .</p>
</div>
<p>注意上述对于凸包 <span class="arithmatex">\(H(D)\)</span> 的定义并不要求 <span class="arithmatex">\(D\)</span> 为凸集，但若 <span class="arithmatex">\(D\)</span> 为凸集则有以下结论：</p>
<details class="note">
<summary>设 <span class="arithmatex">\(D\)</span> 为凸集，则 <span class="arithmatex">\(D\)</span> 中任意 <span class="arithmatex">\(m\)</span> 个点的凸组合都在 <span class="arithmatex">\(D\)</span> 中. 也即有 <span class="arithmatex">\(H(D)\subset D\)</span> .</summary>
<p>证明：用归纳法证明， <span class="arithmatex">\(n=2\)</span> 是显然成立，设 <span class="arithmatex">\(n=k\)</span> 时也成立，对于 <span class="arithmatex">\(n=k+1\)</span> ： 设 <span class="arithmatex">\(x_1,\cdots,x_{k+1}\)</span> ，注意到 </p>
<div class="arithmatex">\[\begin{aligned}
\sum\limits_{i=1}^{k+1}\alpha_ix_i &amp;=\alpha_{k+1}x_{k+1}+\sum\limits_{i=1}^{k}\alpha_ix_i\\
&amp;=\alpha_{k+1}x_{k+1}+(1-\alpha_{k+1})\sum\limits_{i=1}^{k}\frac{\alpha_i}{1-\alpha_{k+1}}x_i
\end{aligned}\]</div>
<p>注意到后者为凸组合包含于 <span class="arithmatex">\(D\)</span> 中，从而得证.</p>
</details>
<p>由定义易得：</p>
<div class="admonition note">
<p class="admonition-title">一族凸集的交仍然为凸集.</p>
</div>
<p>进而可以证明：</p>
<details class="note">
<summary>对于 <span class="arithmatex">\(D\subset \mathbb{R}^n\)</span> ， <span class="arithmatex">\(H(D)\)</span> 是所有包含 <span class="arithmatex">\(D\)</span> 的凸集中最小的凸集.</summary>
<p>证明：</p>
<div class="arithmatex">\[H(D)=\left\{\sum\limits_{i=1}^{k}\lambda_ix_i:k\in \mathbb{N},\lambda_i&gt;0,\sum\limits_{i=1}^{k}\lambda_i=1,x_i\in D\right\}\]</div>
<p>对于任意的 <span class="arithmatex">\(\sum\limits_{i=1}^{k_1}\lambda^1_ix^1_i,\cdots,\sum\limits_{i=1}^{k_m}\lambda^m_ix^m_i\)</span> ，考虑 </p>
<div class="arithmatex">\[\sum\limits_{j=1}^{m}\alpha_j\left(\sum\limits_{i=1}^{k_j}\lambda^j_ix_i^j\right)=\sum\limits_{j=1}^{m}\sum\limits_{i=1}^{k_j}\alpha_j\lambda_i^jx_i^j\]</div>
<p>注意到 </p>
<div class="arithmatex">\[\sum\limits_{j=1}^{m}\sum\limits_{i=1}^{k_j}\alpha_j\lambda_i^j=\sum\limits_{j=1}^{m}\alpha_j\sum\limits_{i=1}^{k_j}\lambda_i^j=\sum\limits_{j=1}^{m}\alpha_j=1\]</div>
<p>从而可知 <span class="arithmatex">\(H(D)\)</span> 为凸集，并且 <span class="arithmatex">\(H(D)\supset D\)</span> .</p>
<p>下面证明 <span class="arithmatex">\(H(D)\)</span> 为包含 <span class="arithmatex">\(D\)</span> 的最小凸集：设 <span class="arithmatex">\(\{B_i\}_{i\in I},B_i\supset D\)</span> 为包含 <span class="arithmatex">\(D\)</span> 的凸集全体，全体凸集的并 <span class="arithmatex">\(\bigcap_{i\in I}B_i\)</span> 仍然为包含 <span class="arithmatex">\(D\)</span> 的凸集，所以 <span class="arithmatex">\(H(D)\supset \bigcap_{i\in I}B_i\)</span> </p>
<p>另一方面注意到 <span class="arithmatex">\(D\subset \bigcap_{i\in I}B_i\)</span> ，所以由凸包的定义可得：</p>
<div class="arithmatex">\[H(D)\subset H(\cap_{i\in I}B_i)\subset \cap_{i\in I}B_i\]</div>
<p>所以 <span class="arithmatex">\(H(D)=\bigcap_{i\in I}B_i\)</span> .</p>
</details>
<p>注意：上面这一定理没有限制 <span class="arithmatex">\(D\)</span> 本身是不是凸集.</p>
<details class="note">
<summary>设 <span class="arithmatex">\(D\subset \mathbb{R}^n\)</span> ， <span class="arithmatex">\(\forall x\in H(D)\)</span> ，其可以表示为 <span class="arithmatex">\(D\)</span> 中至多 <span class="arithmatex">\(n+1\)</span> 个点的凸组合.</summary>
<p>证明：不妨设 <span class="arithmatex">\(x=\sum\limits_{i=1}^{N}\lambda_ix_i,x_i\in D\)</span> 并且 <span class="arithmatex">\(\sum\limits_{i=1}^{N}\lambda_i=1,\lambda_i&gt;0\)</span> . 不妨设 <span class="arithmatex">\(N&gt;n+1\)</span> ，则对于 <span class="arithmatex">\(x_i,1\leq i\leq N\)</span> ，存在不全为 <span class="arithmatex">\(0\)</span> 的数 <span class="arithmatex">\(\mu_i,2\leq i\leq N,\sum\limits_{i=2}^{N}\mu_i(x_i-x_1)=0\)</span> ，令 <span class="arithmatex">\(\mu_1=-\sum\limits_{i=2}^{N}\mu_i\)</span> ，则有 <span class="arithmatex">\(\sum\limits_{i=1}^{N}\mu_ix_i=0\)</span> . 断言： <span class="arithmatex">\(\mu_i,1\leq i\leq N\)</span> 中至少有一个正数，若不然 <span class="arithmatex">\(\mu_1\)</span> 则为正数，矛盾！下面取 <span class="arithmatex">\(\alpha\geq0\)</span> ，使得 </p>
<div class="arithmatex">\[x=\sum\limits_{i=1}^{N}\lambda_ix_i-\alpha \sum\limits_{i=1}^{N}\mu_ix_i=\sum\limits_{i=1}^{N}(\lambda_i-\alpha \mu_i)x_i\]</div>
<p>因为 <span class="arithmatex">\(\lambda_i&gt;0\)</span> ，所以对于 <span class="arithmatex">\(\mu_i,1\leq i\leq N\)</span> 中的正项（已经证明至少存在一个） <span class="arithmatex">\(\{\mu_{i_1},\cdots \mu_{i_k}\}\)</span>可以取 <span class="arithmatex">\(\alpha=\min\{\frac{\lambda_{i_m}}{\mu_{i_m}}:1\leq m\leq k\}=\frac{\lambda_j}{\mu_j}\)</span> ，进而 <span class="arithmatex">\(x=\sum\limits_{i\neq j}^{}(\lambda_i-\alpha \mu_i)x_i\)</span> ，由归纳法即可得到结论.<br />
^AtMostnplus1</p>
</details>
<p>除了一族凸集的交仍然为凸集外，不难证明以下<strong>保凸运算</strong>：</p>
<details class="note">
<summary>凸集的内部和闭包仍然为凸集.</summary>
<p>证明：设 <span class="arithmatex">\(D\)</span> 为凸集，对于 <span class="arithmatex">\(D^\circ\)</span> ，首先固定 <span class="arithmatex">\(t\in(0,1)\)</span> ，对于 <span class="arithmatex">\(U=tD^\circ+(1-t)D^\circ\subset D\)</span> ，不难证明 <span class="arithmatex">\(tD^\circ\)</span> 是开集，注意到 <span class="arithmatex">\(<span class="arithmatex">\(U=\bigcup_{x\in (1-t)D^\circ}(tD^\circ+x)\)</span>\)</span> 为开集，从而有 <span class="arithmatex">\(U=U^\circ\subset D^\circ\)</span> ，因此 <span class="arithmatex">\(D^\circ\)</span> 是凸集.</p>
<p>对于凸集 <span class="arithmatex">\(D\subset \mathbb{R}^n\)</span> 的闭包 <span class="arithmatex">\(\bar{D}\)</span> ，取其中任意两点 <span class="arithmatex">\(a,b\)</span> ，从而存在 <span class="arithmatex">\(D\)</span> 中收敛到 <span class="arithmatex">\(a,b\)</span> 的子列 <span class="arithmatex">\(\{a_n\}_{n\geq1}\)</span> ， <span class="arithmatex">\(\{b_n\}_{n\geq1}\)</span> ，对于任意给定的 <span class="arithmatex">\(\lambda\in(0,1)\)</span> 有： <span class="arithmatex">\(<span class="arithmatex">\(\lambda a_n+(1-\lambda)b_n\in D,\forall n\geq1\)</span>\)</span> 反证： <span class="arithmatex">\(\lambda a+(1-\lambda)b\in \bar{D}^c\)</span> ，则 <span class="arithmatex">\(\lambda a_n+(1-\lambda)b_n\)</span> 将终在 <span class="arithmatex">\(\bar{D}^c\)</span> 中，矛盾！可得到结论.</p>
</details>
<details class="note">
<summary>设仿射函数 <span class="arithmatex">\(f:\mathbb{R}^m\rightarrow \mathbb{R}^n,x\mapsto Ax+b,A\in \mathbb{R}^{n\times m},b\in \mathbb{R}^n\)</span> ，对于凸集 <span class="arithmatex">\(S\)</span> ， <span class="arithmatex">\(f(S)\)</span> 和 <span class="arithmatex">\(f^{-1}(S)\)</span> 都是凸集. 更一般的，凸集的数量乘积和平移都不改变凸性.</summary>
<p>证明： <span class="arithmatex">\(f(S)\)</span> 的显然，对于 <span class="arithmatex">\(f^{-1}(S)\)</span> 中的凸组合 <span class="arithmatex">\(\sum\limits_{i=1}^{N}\lambda_ix_i\)</span> ，注意到 <span class="arithmatex">\(f\left(\sum\limits_{i=1}^{N}\lambda_i x_i\right)=\sum\limits_{i=1}^{N}\lambda_i (Ax_i+b)\)</span> ，从而可得结论.</p>
</details>
<details class="note">
<summary>凸集的和仍然为凸集.</summary>
</details>
<details class="note">
<summary>凸集到几个象限的投影仍然是凸集. e.g. 设 <span class="arithmatex">\(S\in \mathbb{R}^2\)</span> 是凸集，则 <span class="arithmatex">\(S_x=\{x:(x,y)\in S\}\)</span> 是凸集.</summary>
</details>
<details class="example">
<summary>定义多面体： <span class="arithmatex">\(H=\{x\in \mathbb{R}^n:Ax\leq b,Cx=d\}\)</span> . 则 <span class="arithmatex">\(H\)</span> 为凸集.</summary>
<p>证明：注意到 <span class="arithmatex">\(A\sum\limits_{i=1}^{N}\lambda_ix_i\leq \sum\limits_{i=1}^{N}\lambda_ib=b\)</span> ，另一个同理.</p>
</details>
<details class="example">
<summary><span class="arithmatex">\(n\)</span> 阶半正定矩阵全体 <span class="arithmatex">\(S_+^n=\cap _{z\neq0}\{X\in S^n:z^TXz\geq0\}\)</span> 是凸集. 线性矩阵不等式的解集为凸集.</summary>
<p><span class="arithmatex">\(S_+^n\)</span> 半正定矩阵为凸集容易验证. 设 <span class="arithmatex">\(A_i,B\in S^m\)</span> ，均为实矩阵，考虑线性不等式 <span class="arithmatex">\(<span class="arithmatex">\(A(x)=x_1A_1+\cdots +x_nA_n\preceq B\)</span>\)</span> 即 <span class="arithmatex">\(B-A(x)\)</span> 是半正定的，令 <span class="arithmatex">\(f(x)=B-A(x)\)</span> ，不难验证 <span class="arithmatex">\(f:\mathbb{R}^n\rightarrow S^m\)</span> 的原像仍然为凸集，进而可得结论. #imcomplete-whatever %%答案的说法是 <span class="arithmatex">\(f\)</span> 是一个仿射函数，没看出来%%</p>
</details>
<details class="note">
<summary>线性分式函数保凸.</summary>
</details>
<p>定义<strong>透视函数</strong>： <span class="arithmatex">\(P:\mathbb{R}^{n+1}\rightarrow \mathbb{R}^n,P(z,t)=z/t\)</span> , <span class="arithmatex">\(\text{dom}(P)=\mathbb{R}^n\times\mathbb{R}_{+ +}\)</span> , <span class="arithmatex">\(\mathbb{R}_<ins class="critic">}\)</span> 表示正实数集. </p>
<details class="note">
<summary>若 <span class="arithmatex">\(C\subset \text{dom}(P)\)</span> 是凸集，则 <span class="arithmatex">\(P(C)\)</span> 是凸集. 反之也成立.</summary>
<p>证明：需要用到透视函数的性质：首先由凸集的定义可知 <span class="arithmatex">\(\forall x_1,x_2\in C\)</span> ，线段 <span class="arithmatex">\(L=\{\lambda(\bar{x}_1,x_1)+(1-\lambda)(\bar{x}_2,x_2),\lambda\in[0,1]\}\)</span> 仍然包含在 <span class="arithmatex">\(C\)</span> 中，并且 <span class="arithmatex">\(<span class="arithmatex">\(P(L)=(\lambda \bar{x}_1+(1-\lambda)\bar{x}_2)/(\lambda x_1+(1-\lambda)x_2)\)</span>\)</span> 令 <span class="arithmatex">\(\mu=\frac{\lambda x_1}{\lambda x_1+(1-\lambda)x_2}\)</span> ，从而可得 <span class="arithmatex">\(P(L)=\mu P((\bar{x}_1,x_1))+(1-\mu)P(\bar{x}_2,x_2)\)</span> . 也就是说任何两个 <span class="arithmatex">\(P(C)\)</span> 中的点形成的线段都包含在 <span class="arithmatex">\(P(C)\)</span> 中（因为 <span class="arithmatex">\(P(L)\subset P(C)\)</span> ）任何凸组合都可以有限的表示为在线段上取一点. 从而可得结论.</p>
<p>另一方面： #imcomplete-whatever </p>
</details>
<p><strong>线性分式函数</strong>则是由透视函数和仿射函数复合定义的：设 <span class="arithmatex">\(g:\mathbb{R}^n\rightarrow \mathbb{R}^{m+1}\)</span> ： </p>
<div class="arithmatex">\[g(x)=\begin{bmatrix}A \\ c^T\end{bmatrix}x+\begin{bmatrix}b  \\ d\end{bmatrix}\]</div>
<p>其中 <span class="arithmatex">\(A\in \mathbb{R}^{m\times n},c\in \mathbb{R}^{n},b\in \mathbb{R}^m,d\in \mathbb{R}\)</span> ，定义线性分式函数： <span class="arithmatex">\(f=P\circ g\)</span> ，即： </p>
<div class="arithmatex">\[f(x)=(Ax+b)/(c^Tx+d)\]</div>
<p>下面定义凸集的<strong>分离</strong>：设 <span class="arithmatex">\(D_1,D_2\subset \mathbb{R}^n\)</span> 是两个凸集，如果存在 <span class="arithmatex">\(\alpha\in \mathbb{R}^n,\alpha\neq0,\beta\in \mathbb{R}\)</span> ，使得 </p>
<div class="arithmatex">\[\begin{aligned}
&amp;D_1\subset H^+=\{x\in \mathbb{R}^n:\alpha^Tx\geq \beta\}\\
&amp;D_2\subset H^-=\{x\in \mathbb{R}^n:\alpha^Tx\leq \beta\}
\end{aligned}\]</div>
<p>则称<strong>超平面</strong> <span class="arithmatex">\(H=\{x\in \mathbb{R}^n:\alpha^Tx=\beta\}\)</span> 为 <span class="arithmatex">\(D_1,D_2\)</span> 的<strong>分离</strong>. 若 <span class="arithmatex">\(D_1,D_2\)</span> 中取 <span class="arithmatex">\(&gt;,&lt;\)</span> 则称 <span class="arithmatex">\(H\)</span> 为 <span class="arithmatex">\(D_1,D_2\)</span> 的<strong>严格分离</strong>. ^SeperateHyperplane</p>
<p>类似于二维或者三维上的凸集，有下面的存在唯一最近点定理：</p>
<details class="note">
<summary>设 <span class="arithmatex">\(D\subset \mathbb{R}^n\)</span> 是非空<u>闭</u>凸集， <span class="arithmatex">\(y\notin D\)</span> ，则 1) 存在唯一 <span class="arithmatex">\(\bar{x}\in D\)</span> 满足 <span class="arithmatex">\(\lVert \bar{x}-y\rVert=\inf_{x\in D}\lVert x-y\rVert\)</span> ；2) <span class="arithmatex">\(\bar{x}:\lVert \bar{x}-y\rVert=\inf_{x\in D}\lVert x-y\rVert\)</span> 当且仅当 <span class="arithmatex">\((x-\bar{x})^T(\bar{x}-y)\geq0\)</span> .</summary>
<p>证明：利用连续函数可以在紧集（在 <span class="arithmatex">\(\mathbb{R}^n\)</span> 中，等价于有界闭集）中可以取得最小值. #imcomplete %%这里最好能更新一下<a href="../R/">实数理论</a>%% 首先取 <span class="arithmatex">\(z\in D\)</span> . 取 <span class="arithmatex">\(R=\lVert y-z\rVert\)</span> ，从而可得 <span class="arithmatex">\(C=\bar{B}(z,R)\cap D\)</span> 为 <span class="arithmatex">\(\mathbb{R}^n\)</span> 上的有界闭集，又 <span class="arithmatex">\(\lVert \cdot\rVert\)</span> 为连续函数（事实上，一致连续），从而可在 <span class="arithmatex">\(C\)</span> 上取得 <span class="arithmatex">\(\inf\)</span> ，记 <span class="arithmatex">\(\lVert \bar{x}-y\rVert=\inf_{x\in C}\lVert x-y\rVert\)</span> ，当 <span class="arithmatex">\(x\notin C\)</span> 时， <span class="arithmatex">\(\lVert x-y\rVert\geq R\geq \lVert \bar{x}-y\rVert\)</span> 因此 <span class="arithmatex">\(\lVert \bar{x}-y\rVert=\inf_{x\in D}\lVert x-y\rVert\)</span> .<br />
对于唯一性的证明：考虑 </p>
<div class="arithmatex">\[\begin{aligned}
\left\lVert \frac{1}{2}\bar{x}-\frac{1}{2}y-\frac{1}{2}y+\frac{1}{2}\bar{x}'\right\rVert &amp;\leq \frac{1}{2}\left\lVert \bar{x}-y\right\rVert+\frac{1}{2}\lVert \bar{x}'-y\rVert\\
&amp;=\lVert \bar{x}-y\rVert
\end{aligned}\]</div>
<p>并且 </p>
<div class="arithmatex">\[\left\lVert \frac{\bar{x}+\bar{x}'}{2}-y\right\rVert\geq\lVert \bar{x}-y\rVert\]</div>
<p>则上不等式可取等，满足取等条件： <span class="arithmatex">\(<span class="arithmatex">\(\frac{1}{2}(\bar{x}-y)=\frac{\alpha}{2}(\bar{x}'-y)\)</span>\)</span> 取模长可得 <span class="arithmatex">\(\alpha=1\)</span> ，从而可得 <span class="arithmatex">\(\bar{x}=\bar{x}'\)</span> .</p>
<p>对 2) ， <span class="arithmatex">\(\rightarrow\)</span> 观察可得 </p>
<div class="arithmatex">\[\begin{aligned}
\lVert x-y\rVert^2 &amp;=\lVert x-\bar{x}+\bar{x}-y\rVert^2\\
&amp;=\lVert x-\bar{x}\rVert^2+\lVert \bar{x}-y\rVert^2+2(x-\bar{x})^T(\bar{x}-y)\\
\end{aligned}\]</div>
<p>但这一形式无法解决问题，因此考虑利用凸集的性质，和上面的 </p>
<div class="arithmatex">\[\begin{aligned}
\lVert \lambda x+(1-\lambda)\bar{x}-y\rVert^2&amp;=\lVert \bar{x}-y+\lambda(x-\bar{x})\rVert^2\\
&amp;=\lVert \bar{x}-y\rVert^2+\lambda^2\lVert x-\bar{x}\rVert^2\\
&amp;+2\lambda(x-\bar{x})^T(\bar{x}-y)\\
&amp;\geq \lVert \bar{x}-y\rVert^2
\end{aligned}\]</div>
<p>从而可以得到</p>
<div class="arithmatex">\[\lambda^2\lVert x-\bar{x}\rVert^2+2\lambda(x-\bar{x})^T(\bar{x}-y)\geq0\]</div>
<p>其中 <span class="arithmatex">\(\lambda\in(0,1)\)</span> ，因此 <span class="arithmatex">\((x-\bar{x})^T(\bar{x}-y)\geq0\)</span> . 利用参数的任意性求解，和 <a href="#atmostnplus1">#^AtMostnplus1</a> 相似.</p>
<p><span class="arithmatex">\(\Leftarrow\)</span> ：直接由</p>
<div class="arithmatex">\[\begin{aligned}\lVert x-y\rVert^2 &amp;=\lVert x-\bar{x}+\bar{x}-y\rVert^2\\ 
&amp;=\lVert x-\bar{x}\rVert^2+\lVert \bar{x}-y\rVert^2+2(x-\bar{x})^T(\bar{x}-y)\\
\end{aligned}
\]</div>
<p>得到结论.</p>
</details>
<p>下面是一个重要的引理，即存在超平面将位于非空闭凸集 <span class="arithmatex">\(D\)</span> 外的一点 <span class="arithmatex">\(y\)</span> 与凸集 <span class="arithmatex">\(D\)</span> 分开：</p>
<details class="note">
<summary>设 <span class="arithmatex">\(D\subset \mathbb{R}^n\)</span> 是非空<u>闭</u>凸集， <span class="arithmatex">\(y\notin D\)</span> ，则存在 <span class="arithmatex">\(\alpha\in \mathbb{R}^n,\alpha\neq0\)</span> ， <span class="arithmatex">\(\beta\in \mathbb{R}\)</span> 使得 <span class="arithmatex">\(\alpha^Tx\leq\beta&lt;\alpha^Ty,\forall x\in D\)</span> .</summary>
<p>证明：已知 <span class="arithmatex">\((x-\bar{x})^T(\bar{x}-y)\geq0\)</span> . 从而 <span class="arithmatex">\((\bar{x}-y)^T(x-\bar{x})\geq0\)</span> ，进而可得 <span class="arithmatex">\(<span class="arithmatex">\((y-\bar{x})^Tx\leq (y-\bar{x})^T\bar{x}\)</span>\)</span> 令 <span class="arithmatex">\(\alpha=y-\bar{x}\)</span> 从而可得： <span class="arithmatex">\(<span class="arithmatex">\(\alpha^Tx\leq \alpha^T\bar{x}=\alpha^T(\bar{x}-y+y)=-\alpha^T\alpha+\alpha^Ty&lt;\alpha^Ty\)</span>\)</span> 并且可取 <span class="arithmatex">\(\beta=\alpha^T\alpha+\alpha^Ty\)</span> 得到结论.</p>
</details>
<p>下面这个定理建立在特定条件下的线性不等式和线性等式之间的等价关系.</p>
<details class="note">
<summary>Farkas 引理：设 <span class="arithmatex">\(A\in \mathbb{R}^{m\times n}\)</span> ， <span class="arithmatex">\(b\in \mathbb{R}^n\)</span> ，则 1. <span class="arithmatex">\(Ax\leq 0,b^Tx&gt;0\)</span> 2. <span class="arithmatex">\(A^Ty=b,y\geq0\)</span> 中有且仅有一个有解.</summary>
<p>证明：假设 <span class="arithmatex">\(1,2\)</span> 均有解 <span class="arithmatex">\(x_0,y_0\)</span> ，则 <span class="arithmatex">\(A^Ty_0=b\rightarrow x\rightarrow x_0^TA^Ty_0=x_0^Tb=(Ax_0)^Ty_0\)</span> ，注意到 <span class="arithmatex">\(Ax_0\leq 0,x_0^Tb&gt;0,y_0\geq0\)</span> 从而可得矛盾. </p>
<p>另一方面，假设 <span class="arithmatex">\(1,2\)</span> 均无解，则取 <span class="arithmatex">\(<span class="arithmatex">\(D=\{z:z=A^Ty,y\geq0\}\)</span>\)</span> 显然 <span class="arithmatex">\(D\)</span> 为非空<u>闭</u>凸集（仿射变换将凸集映射到凸集）并且 <span class="arithmatex">\(b\notin D\)</span> ，从而对于存在 <span class="arithmatex">\(\alpha\in \mathbb{R}^n,\beta\in \mathbb{R}\)</span> ，对任意的 <span class="arithmatex">\(z\in D\)</span> ，有： <span class="arithmatex">\(<span class="arithmatex">\((A\alpha)^Ty=\alpha^TA^Ty=\alpha^Tz\leq\beta&lt;\alpha^Tb=b^T\alpha,\forall y\geq0\)</span>\)</span> </p>
<p>注意到 <span class="arithmatex">\(b^T\alpha&gt;(A\alpha)^T0=0\)</span> . 而若 <span class="arithmatex">\(A\alpha\)</span> 中存在分量 <span class="arithmatex">\(&gt;0\)</span> 由 <span class="arithmatex">\(y\)</span> 的任意性，可以取对应分量位置的正值而其余位置为 <span class="arithmatex">\(0\)</span> ，可得 <span class="arithmatex">\(\exists y',(A\alpha)^Ty'&gt;b^T\alpha\)</span> ，所以 <span class="arithmatex">\(A\alpha\leq0\)</span> ，这与 <span class="arithmatex">\(1\)</span> 无解矛盾！<br />
综上 1. 2. 有且只有一个有解.<br />
^Farkas</p>
</details>
<p>下面定义<strong>支撑</strong>的概念：设 <span class="arithmatex">\(D\)</span> 为非空集合， <span class="arithmatex">\(\bar{x}\in \partial{D}\)</span> ，若存在 <span class="arithmatex">\(\alpha\neq0\)</span> 使得 <span class="arithmatex">\(<span class="arithmatex">\(D\subset H_{\bar{x}}^+=\{x:\alpha^T(x-\bar{x})\geq0\}\)</span>\)</span> 或者 <span class="arithmatex">\(<span class="arithmatex">\(D\subset H_{\bar{x}}^-=\{x:\alpha(x-\bar{x})\leq0\}\)</span>\)</span> 则称超平面 <span class="arithmatex">\(H_{\bar{x}}=\{x:\alpha(x-\bar{x})=0\}\)</span> 为 <span class="arithmatex">\(D\)</span> 在 <span class="arithmatex">\(\bar{x}\)</span> 处的<strong>支撑超平面</strong>.</p>
<p>下面这个定理说明了凸集的边界上的点的特殊性质：存在一个包含该点的超平面，使得凸集的闭包上的所有点均位于该超平面的一侧（可以位于该超平面上）</p>
<details class="note">
<summary>设 <span class="arithmatex">\(D\)</span> 为非空凸集， <span class="arithmatex">\(\bar{x}\in\partial{D}\)</span> ，则存在 <span class="arithmatex">\(\alpha\neq0,\alpha\in \mathbb{R}^n\)</span> 使得 <span class="arithmatex">\(\alpha^Tx\leq \alpha^T\bar{x},\forall x\in \bar{D}\)</span> .</summary>
<p>证明：因为 <span class="arithmatex">\(\bar{x}\in \partial{D}\)</span> ，所以存在点列 <span class="arithmatex">\(\{x_n\}_{n\geq1}\rightarrow \bar{x},x_n\notin \bar{D},\forall n\geq1\)</span> ，注意到 <span class="arithmatex">\(\bar{D}\)</span> 为非空<u>闭</u>凸集（凸集的闭包是凸集之前已经证明过），根据上面的引理可知，存在 <span class="arithmatex">\(\{\alpha_n\}_{n\geq1}\)</span> 使得： <span class="arithmatex">\(<span class="arithmatex">\(\alpha_n^Tx&lt;\alpha_n^Tx_n,\forall x\in \bar{D}\)</span>\)</span> 进而有： <span class="arithmatex">\(<span class="arithmatex">\(\frac{\alpha_n^T}{\lVert \alpha_n\rVert}x&lt;\frac{\alpha_n^T}{\lVert \alpha_n\rVert}x_n,\forall x\in \bar{D}\)</span>\)</span> 有界序列有收敛子列： <span class="arithmatex">\(\left\{\frac{\alpha_{n_k}^T}{\lVert \alpha_{n_k}\rVert}\right\}_{k\geq1}\rightarrow \alpha\)</span>  ，从而可得 <span class="arithmatex">\(\alpha^T x\leq \alpha^T x_n\)</span> ，再令 <span class="arithmatex">\(n\rightarrow \infty\)</span> 可得 <span class="arithmatex">\(\alpha^Tx\leq \alpha^T \bar{x}\)</span> .</p>
</details>
<p>下面这个定义说明了更一般的情况：讨论 <span class="arithmatex">\(\bar{x}\notin D\)</span> 但不再限制 <span class="arithmatex">\(D\)</span> 是闭集.</p>
<details class="note">
<summary>设 <span class="arithmatex">\(D\)</span> 是非空凸集， <span class="arithmatex">\(\bar{x}\notin D\)</span> ，则存在 <span class="arithmatex">\(\alpha\neq0\)</span> 使得 <span class="arithmatex">\(\alpha^T x\leq \alpha^T\bar{x},\forall x\in \bar{D}\)</span> .</summary>
<p>证明：不妨设 <span class="arithmatex">\(\bar{x}\notin \partial{D}\cup D\)</span> ，由 <span class="arithmatex">\(\bar{D}\)</span> 为非空闭凸集即可得到结论.</p>
</details>
<p>下面这个定理说明了两个不相交非空凸集之间存在分离超平面：</p>
<details class="note">
<summary>设 <span class="arithmatex">\(D_1,D_2\)</span> 是两个非空凸集并且 <span class="arithmatex">\(D_1\cap D_2=\emptyset\)</span> ，则存在 <span class="arithmatex">\(\alpha\neq0\)</span> 使得 <span class="arithmatex">\(\alpha^Tx\leq \alpha^Ty,\forall x\in \bar{D}_1,x_2\in \bar{D}_2\)</span> .</summary>
<p>证明：令 <span class="arithmatex">\(D=D_1-D_2\)</span> 则 <span class="arithmatex">\(D\)</span> 为并且 <span class="arithmatex">\(0\neq D\)</span> ，从而存在 <span class="arithmatex">\(\alpha\in \mathbb{R}^n\)</span> 使得： <span class="arithmatex">\(<span class="arithmatex">\(\alpha^T(x-y)\leq \alpha^T0=0,\forall x\in D_1,y\in D_2\)</span>\)</span> 从而可得 <span class="arithmatex">\(\alpha^Tx\leq \alpha^Ty\)</span> （这里因为 <span class="arithmatex">\(D\subset \bar{D}\)</span> ，所以可以直接这样写） 令 <span class="arithmatex">\(\beta=\sup\{\alpha^Tx:x\in D_1\}\)</span> ，从而可得 <span class="arithmatex">\(<span class="arithmatex">\(\alpha^Tx\leq \beta\leq \alpha^Ty,\forall x,y\in D_1,D_2\)</span>\)</span> 注意到 <span class="arithmatex">\(f(x)=\alpha^Tx\)</span> 是连续函数，所以 <span class="arithmatex">\(<span class="arithmatex">\(\alpha^Tx\leq \beta\leq \alpha^Ty,\forall x,y\in D_1,D_2\)</span>\)</span> 否则若 <span class="arithmatex">\(\alpha^Tx_0&gt;\beta,x_0\in \bar{D_1}-D_1\)</span> ，则存在 <span class="arithmatex">\(x_0\)</span> 的一个最够小的邻域仍然满足，并且与 <span class="arithmatex">\(D_1\)</span> 有交点，矛盾！</p>
</details>
<p>之前已经介绍了<a href="#^Farkas">Farkas 引理</a>，下面介绍的引理</p>
<h3 id="_4">凸函数<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>设 <span class="arithmatex">\(f:D\subset \mathbb{R}^n\rightarrow \mathbb{R}\)</span> ，其中 <span class="arithmatex">\(D\)</span> 为凸集，称 <span class="arithmatex">\(f\)</span> 是 <span class="arithmatex">\(D\)</span> 上的<strong>凸函数</strong>，如果对于任意的 <span class="arithmatex">\(x,y\in D,\lambda\in (0,1)\)</span> 有： <span class="arithmatex">\(f(\lambda x+(1-\lambda)y)\leq \lambda f(x)+(1-\lambda)f(y)\)</span> .</p>
<p>当被优化函数为凸函数时称为凸优化问题，其具有如下的良好性质：</p>
<div class="admonition note">
<p class="admonition-title">凸函数的局部最优点即为全局最优点.</p>
</div>
<p>下面给出如何判断一个函数是凸函数. 从 <span class="arithmatex">\(C^1,C^2\)</span> 分别考虑.</p>
<div class="admonition note">
<p class="admonition-title">📍 设 <span class="arithmatex">\(f(x)\)</span> 是定义在凸集 <span class="arithmatex">\(D\)</span> 上的连续可微函数，则 1) <span class="arithmatex">\(f\)</span> 为 <span class="arithmatex">\(D\)</span> 上凸函数的充分必要条件是 <span class="arithmatex">\(f(y)\geq f(x)+\nabla f(x)^T(y-x),\forall x,y\in D\)</span> ；2) <span class="arithmatex">\(f\)</span> 是 <span class="arithmatex">\(D\)</span> 上的严格凸函数的充要条件是 <span class="arithmatex">\(f(y)&gt;f(x)+\nabla f(x)^T(y-x),\forall y,x\in D,x\neq y\)</span> .</p>
<p>证明： <span class="arithmatex">\(\Rightarrow\)</span> ：对于任意的 <span class="arithmatex">\(x,y\in D,\lambda\in(0,1)\)</span> </p>
<div class="arithmatex">\[\begin{aligned}
&amp;f(\lambda x+(1-\lambda)y)\leq \lambda f(x)+(1-\lambda)f(y)\\
&amp;\frac{f(y+\lambda(x-y))-f(y)}{\lambda}\leq f(x)-f(y)
\end{aligned}\]</div>
<p>令 <span class="arithmatex">\(\lambda\rightarrow 0\)</span> 可得： <span class="arithmatex">\(\nabla f(y)^T(x-y)\leq f(x)-f(y)\)</span> .</p>
<p><span class="arithmatex">\(\Leftarrow\)</span> ：对于任意的 <span class="arithmatex">\(x,y\in D,\lambda\in(0,1)\)</span> ，取 <span class="arithmatex">\(z=\lambda x+(1-\lambda)y\)</span> ，从而可以得到：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;f(z)+\nabla f(z)^T(y-z)\leq f(y)\quad (1)\\
&amp;f(z)+\nabla f(z)^T(x-z)\leq f(x)\quad (2)\\
\end{aligned}\]</div>
<p><span class="arithmatex">\(\lambda(1)+(1-\lambda)(2)\)</span> 可以得到：</p>
<div class="arithmatex">\[f(z)\leq \lambda f(y)+(1-\lambda)f(y)\]</div>
<p>对于严格凸的情形， <span class="arithmatex">\(\Leftarrow\)</span> 是类似的，但对于 <span class="arithmatex">\(\Rightarrow\)</span> 不能确定是严格不等. 为此，不妨假设 <span class="arithmatex">\(\exists x,y\in D\)</span> 使得 <span class="arithmatex">\(f(y)=f(x)+\nabla f(x)^T(y-x)\)</span> . 因此可以得到：</p>
<div class="arithmatex">\[\begin{aligned}
\frac{f(y)+f(x)}{2}&amp;=f(x)+\nabla f(x)^T\left(\frac{x+y}{2}-x\right)\\
&amp;\geq f\left(\frac{x+y}{2}\right)
\end{aligned}\]</div>
<p>矛盾！因此取严格不等.</p>
</div>
<p>因此有推论：</p>
<div class="admonition note">
<p class="admonition-title"><span class="arithmatex">\(f\)</span> 为定义在凸集 <span class="arithmatex">\(D\)</span> 上的一阶连续可微函数，则 <span class="arithmatex">\(x\)</span> 为 <span class="arithmatex">\(D\)</span> 的全局最优点当且仅当 <span class="arithmatex">\(\nabla f(x)=0\)</span> .</p>
</div>
<div class="admonition note">
<p class="admonition-title">设 <span class="arithmatex">\(f(x)\)</span> 是<u>非空开凸集</u> <span class="arithmatex">\(D\subset \mathbb{R}^n\)</span> 上的<u>二阶连续可微</u>函数，则 1) <span class="arithmatex">\(f\)</span> 是 <span class="arithmatex">\(D\)</span> 上的凸函数的充要条件是 <span class="arithmatex">\(\nabla^2f(x)\)</span> 在 <span class="arithmatex">\(D\)</span> 中<u>半正定</u>；2) 若 <span class="arithmatex">\(\nabla^2f(x)\)</span> 在 <span class="arithmatex">\(D\)</span> 中正定，则 <span class="arithmatex">\(f(x)\)</span> 是 <span class="arithmatex">\(D\)</span> 上的严格凸函数.</p>
</div>
<p>下面讨论凸函数的哪些运算仍然是凸函数.</p>
<h2 id="_5">线性规划<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<p><strong>线性规划</strong>（linear programming ，LP）的标准形式为：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;\min\ a_1x_1+\cdots+a_nx_n\\
&amp;s.t. \ a_{i_1}x_1+\cdots+a_{i_n}x_n=b_i\\
&amp;\quad\ i=1,\cdots,m,x_j\geq0,j=1,\cdots,n
\end{aligned}\]</div>
<p>矩阵形式：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;\min\ c^Tx\\
&amp;s.t.\ Ax=b\\
&amp;\quad\quad x\geq0
\end{aligned}\]</div>
<p>设 <span class="arithmatex">\(\text{rank}(A)=m,b\geq0\)</span> ，并且 <span class="arithmatex">\(m\leq n\)</span> . </p>
<p>线性规划的可行域是一个<strong>多面体</strong>，为凸集.</p>
<p>可以通过引入变量的方式以将非标准形式的线性规划转化为标准形式，e.g. 满足约束条件 <span class="arithmatex">\(x\ge 0\)</span> .</p>
<p>由 <span class="arithmatex">\(\text{rank}(A)=m\)</span> ，设 <span class="arithmatex">\(A=[B\ N]\)</span> ， <span class="arithmatex">\(B\)</span> 为 <span class="arithmatex">\(m\)</span> 阶非奇异矩阵，相应地令 <span class="arithmatex">\(x=\begin{bmatrix}x_B &amp; x_N\end{bmatrix}\)</span> 从而可得 <span class="arithmatex">\(Ax=Bx_B+Nx_N=b\)</span> ，从而 <span class="arithmatex">\(x_B=B^{-1}b-B^{-1}Nx_N\)</span> ，所以 <span class="arithmatex">\(Ax=b\)</span> 有一解 <span class="arithmatex">\(\begin{bmatrix}B^{-1}b\\ 0\end{bmatrix}\)</span> ，称为<strong>基本解</strong>；如果 <span class="arithmatex">\(B^{-1}b\geq0\)</span> ，则 <span class="arithmatex">\(\begin{bmatrix}B^{-1}b\\ 0\end{bmatrix}\)</span> 即为该线性规划问题的解，称为<strong>基本可行解</strong>. </p>
<div class="admonition warning">
<p class="admonition-title">提醒</p>
<p><span class="arithmatex">\(A\)</span> 中的 <span class="arithmatex">\(m\)</span> 阶非奇异矩阵可能有多个，所以可能有多个基本可行解，此外注意，将 <span class="arithmatex">\(A\)</span> 写作 <span class="arithmatex">\([B,N]\)</span> 只是方便表示，实际计算时，只需要确定 <span class="arithmatex">\(A\)</span> 中的 <span class="arithmatex">\(m\)</span> 个线性无关列对应的列索引（基指标）即可，下面的所有表示都是如此.</p>
</div>
<p>在处理简单的二维线性规划问题时，极值一般都在多边形（多面体）的顶点处取得，在线性规划中也有这一结论，但首先需要明确顶点的定义.</p>
<p>定义<strong>顶点</strong>（极点）：设 <span class="arithmatex">\(S\subset \mathbb{R}^n\)</span> 是凸集，如果<u>存在</u> <span class="arithmatex">\(\lambda\in(0,1),y,z\in S\)</span> ， <span class="arithmatex">\(x=\lambda y+(1-\lambda)z\Rightarrow x=y=z\)</span> .</p>
<details class="example">
<summary>闭球体 <span class="arithmatex">\(S:\{x:x^Tx=1\}\)</span> 的顶点全体为 <span class="arithmatex">\(\partial{S}\)</span> .</summary>
</details>
<details class="example">
<summary><span class="arithmatex">\(\{x:x_1+x_2+x_3\leq1,x_i\geq0,i=1,2,3\}\)</span> 的顶点为 <span class="arithmatex">\((1,0,0)^T,(0,1,0)^T,(0,0,1)^T\)</span> .</summary>
</details>
<div class="admonition note">
<p class="admonition-title"><span class="arithmatex">\(x\)</span> 是可行域 <span class="arithmatex">\(F=\{x:Ax=b,x\geq0\}\)</span> 的一个顶点的充要条件是 <span class="arithmatex">\(x\)</span> 是 LP 标准形式的一个基本可行解 <span class="arithmatex">\(\begin{bmatrix}B^{-1}b\\ 0\end{bmatrix}\)</span> .</p>
</div>
<p>由上结论，依据 <span class="arithmatex">\(B^{-1}\)</span> 为从 <span class="arithmatex">\(A\)</span> 的线性无关列中选取而组成的可知，线性规划的可行域 <span class="arithmatex">\(F\)</span> 的顶点有限. 因此可以通过穷举的方法找到基本可行解，但是否是最优解？需要进一步讨论.</p>
<div class="admonition warning">
<p class="admonition-title">此处，<u>基本可行解</u>等同于顶点.</p>
<p>可行解不一定是顶点，在可行域 <span class="arithmatex">\(F\)</span> 中.</p>
</div>
<p>设 <span class="arithmatex">\(D\)</span> 是一个凸集， <span class="arithmatex">\(d\)</span> 是一个向量，如果 <span class="arithmatex">\(\forall x\in D,\alpha\geq0\)</span> ，都有 <span class="arithmatex">\(x+\alpha d\in D\)</span> 则称 <span class="arithmatex">\(d\)</span> 为 <span class="arithmatex">\(D\)</span> 的一个<strong>方向</strong>.</p>
<p>下面则是两个多面题理论的定理，从直观上对于可行域和顶点有一个感知.</p>
<div class="admonition note">
<p class="admonition-title">若 <span class="arithmatex">\(F\)</span> 有界，则 <span class="arithmatex">\(F=\{F\text{ 的顶点的凸组合}\}\)</span> .</p>
</div>
<div class="admonition note">
<p class="admonition-title">若 <span class="arithmatex">\(F\)</span> 无界，则任一可行域中的点 <span class="arithmatex">\(x\)</span> 都可以表示为 <span class="arithmatex">\(x=\sum\limits_{i=1}^{k}\alpha_iv_i+\alpha d\)</span> ，其中 <span class="arithmatex">\(\sum\limits_{i=1}^{k}\alpha_i=1,\alpha_i\geq0\)</span> ， <span class="arithmatex">\(v_i\)</span> 为 <span class="arithmatex">\(F\)</span> 的顶点， <span class="arithmatex">\(\alpha\geq0\)</span> ， <span class="arithmatex">\(d\)</span> 为 <span class="arithmatex">\(F\)</span> 的一个方向.</p>
</div>
<p>最后，可以证明最优解为顶点，即为基本可行解.</p>
<div class="admonition note">
<p class="admonition-title">若线性规划标准形式有解，则其必然在可行域 <span class="arithmatex">\(F\)</span> 的某个<u>顶点</u>处达到最优值.</p>
</div>
<p>自然想要知道，是否存在一种算法能够求解顶点.</p>
<h3 id="_6">单纯形算法<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<div class="arithmatex">\[\begin{aligned}
&amp;\min\ c^Tx\\
&amp;s.t.\ Ax=b\\
&amp;\quad\quad x\geq0
\end{aligned}\]</div>
<p>设 <span class="arithmatex">\(A\in \mathbb{R}^{m\times n},b\ge0,\text{rank}(A)=m\leq n\)</span> ，</p>
<p>设 <span class="arithmatex">\(A=[B\ N]\)</span> ，其中 <span class="arithmatex">\(\text{rank}(B)=m\)</span> ，称 <span class="arithmatex">\(B\)</span> 为<strong>基矩阵</strong>， <span class="arithmatex">\(N\)</span> 为<strong>非基阵</strong>. 并记 <span class="arithmatex">\(B\)</span> 和 <span class="arithmatex">\(N\)</span> 的列标号为<strong>基指标</strong>和<strong>非基指标</strong>. 按照基、非基指标，可以将 <span class="arithmatex">\(x\)</span> 划分为 <span class="arithmatex">\(\begin{bmatrix}x_B \\ x_N\end{bmatrix}\)</span> ，其中 <span class="arithmatex">\(x_B,x_N\)</span> 分别称为<strong>基变量</strong>和<strong>非基变量</strong>. </p>
<p>单纯形算法提供了一种从基本可行解转换到另一个基本可行解的方法，直到达到最优解.</p>
<p>为理解单纯形算法，需要分析两点：1) 如何判定达到最优解；2) 如何变换基本可行解.</p>
<p>首先有如下的最优解辨别条件：</p>
<div class="admonition note">
<p class="admonition-title">设 <span class="arithmatex">\(x=\begin{bmatrix}B^{-1}b \\ 0\end{bmatrix}\)</span> 为线性规划问题的一个基本可行解，当 <span class="arithmatex">\(\Delta=c_N-c_BB^{-1}N\ge0\)</span> 时 <span class="arithmatex">\(x\)</span> 为最优解.</p>
<p>证明：设 <span class="arithmatex">\(x'=\begin{bmatrix}x_B \\ x_N\end{bmatrix}\)</span> 为线性规划问题的一个可行解，其中 <span class="arithmatex">\(x_B,x_N\)</span> 是按照 <span class="arithmatex">\(x\)</span> 的 <span class="arithmatex">\(B,N\)</span> 划分的，并且注意到 <span class="arithmatex">\(Bx_B+Nx_N=b\Rightarrow x_B=B^{-1}(b-Nx_N)\)</span></p>
<p>则有：</p>
<div class="arithmatex">\[\begin{aligned}
c_B^Tx_B+c_N^Tx_N&amp;=c_B^TB^{-1}b+(c_N^T-c_B^TB^{-1}N)x_N\\
&amp;\ge c_B^TB^{-1}b
\end{aligned}\]</div>
<p>注意这里用到了 <span class="arithmatex">\(x\ge0\)</span> ，即标准线性规划问题.</p>
</div>
<p>单纯形算法步骤如下：</p>
<ol>
<li>初始化<u>基本可行解</u> <span class="arithmatex">\(x_0\)</span> ，确定 <span class="arithmatex">\(A\)</span> 中的基阵 <span class="arithmatex">\(B\)</span> 和非基阵 <span class="arithmatex">\(N\)</span> ；基指标 <span class="arithmatex">\(I_B=\{i_1,\cdots,i_m\}\)</span> ，非基指标 <span class="arithmatex">\(I_N=[n]\backslash I_B\)</span> .</li>
<li>当 <span class="arithmatex">\(\Delta=c_N^T-c_B^TB^{-1}N\not\ge0\)</span> 时：<ol>
<li>求非基指标 <span class="arithmatex">\(k:c_k-c_B^TB^{-1}a_k=\min\{c_i-c_B^TB^{-1}a_i:i\in I_N\}\)</span> ；</li>
<li>求基指标 <span class="arithmatex">\(i_r:\frac{(B^{-1}b)_{i_r}}{(B^{-1}a_k)_{i_r}}=\min\left\{\frac{(B^{-1}b)_{i_j}}{(B^{-1}a_k)_{i_j}}:1\leq j\leq m\right\}\)</span> ；</li>
<li>交换 <span class="arithmatex">\(k\)</span> 和 <span class="arithmatex">\(i_r\)</span> ，得到新的基阵 <span class="arithmatex">\(B\)</span> 和非基阵 <span class="arithmatex">\(N\)</span> ；</li>
</ol>
</li>
<li>输出 <span class="arithmatex">\(B^{-1}b\)</span> .</li>
</ol>
<p>原始单纯形算法的缺点在于 <span class="arithmatex">\(B^{-1}\)</span> 需要从头计算. 而实际上每一次只修改了 <span class="arithmatex">\(B\)</span> 的一列.</p>
<h4 id="_7">修正单纯形算法：<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<p>单纯形表如下：</p>
<table>
<thead>
<tr>
<th></th>
<th><span class="arithmatex">\(x_B^T\)</span></th>
<th><span class="arithmatex">\(x_N^T\)</span></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><span class="arithmatex">\(0\)</span></td>
<td><span class="arithmatex">\(c_N^T-c_B^TB^{-1}N\)</span></td>
<td></td>
</tr>
<tr>
<td><span class="arithmatex">\(I_B\)</span></td>
<td><span class="arithmatex">\(I\)</span></td>
<td><span class="arithmatex">\(B^{-1}N\)</span></td>
<td><span class="arithmatex">\(B^{-1}b\)</span></td>
</tr>
</tbody>
</table>
<ol>
<li>初始化<u>基本可行解</u> <span class="arithmatex">\(x_0\)</span> ，确定 <span class="arithmatex">\(A\)</span> 中的基阵 <span class="arithmatex">\(B\)</span> 和非基阵 <span class="arithmatex">\(N\)</span> ；基指标 <span class="arithmatex">\(I_B=\{i_1,\cdots,i_m\}\)</span> ，非基指标 <span class="arithmatex">\(I_N=[n]\backslash I_B\)</span> .</li>
<li>当 <span class="arithmatex">\(\Delta=c_N^T-c_B^TB^{-1}N\not\geq0\)</span> 时：<ol>
<li>求非基指标 <span class="arithmatex">\(k:c_k-c_B^TB^{-1}a_k=\min\{c_i-c_B^TB^{-1}a_i:i\in I_N\}\)</span> ；</li>
<li>求基指标 <span class="arithmatex">\(i_r:\frac{(B^{-1}b)_{i_r}}{(B^{-1}a_k)_{i_r}}=\min\left\{\frac{(B^{-1}b)_{i_j}}{(B^{-1}a_k)_{i_j}}:1\leq j\leq m\right\}\)</span> ；</li>
<li>以 <span class="arithmatex">\((B^{-1}a_{k})_{i_r}\)</span> 为主元素对于单纯形表进行 Gauss - Jordan 消元，并将 <span class="arithmatex">\(k\)</span> 替换 <span class="arithmatex">\(i_r\)</span> 作为基指标.</li>
</ol>
</li>
<li>输出 <span class="arithmatex">\(B^{-1}b\)</span> .</li>
</ol>
<p>使用 Python 中的 <code>scipy</code> 实现单纯形算法如下，注意 <code>scipy 1.11.0</code> 之后 <code>simplex</code> 就被放弃，因为 <code>highs</code> 更高效.</p>
<p>格式为：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;\min\quad c^Tx\\
&amp;s.t.\quad\ A_{ub}x\leq b_{ub}\\
&amp;\qquad \quad A_{eq}x=b_{eq}\\
&amp;\qquad \quad l\leq x\leq u
\end{aligned}\]</div>
<p>下面的实现，习惯上把转化为限制条件是等式的情况.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">单纯形算法</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
 <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">linprog</span>

 <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
 <span class="n">A_eq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
               <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
 <span class="n">b_eq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

 <span class="n">solu</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A_eq</span><span class="o">=</span><span class="n">A_eq</span><span class="p">,</span> <span class="n">b_eq</span><span class="o">=</span><span class="n">b_eq</span><span class="p">)</span>
 <span class="nb">print</span><span class="p">(</span><span class="n">solu</span><span class="p">)</span> 
</code></pre></div></td></tr></table></div>
<div class="collapse-code"><input checked="checked" id="__collapse0" name="__collapse0" type="checkbox" /><div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">输出</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># 我没搞懂为什么 scipy 版本一样， Linux 的 Python3 (3.11.5) 和 Conda 的 Python (3.11.5) 跑出来的结果不同</span>

<span class="c1"># scipy==1.12.0</span>
$<span class="w"> </span>python3<span class="w"> </span>simplex_method.py<span class="w"> </span>
<span class="w">     </span>con:<span class="w"> </span>array<span class="o">([</span><span class="m">3</span>.97332833e-10,<span class="w"> </span><span class="m">7</span>.94608823e-11<span class="o">])</span>
<span class="w">     </span>fun:<span class="w"> </span>-11.999999999208926
<span class="w"> </span>message:<span class="w"> </span><span class="s1">&#39;Optimization terminated successfully.&#39;</span>
<span class="w">     </span>nit:<span class="w"> </span><span class="m">4</span>
<span class="w">   </span>slack:<span class="w"> </span>array<span class="o">([]</span>,<span class="w"> </span><span class="nv">dtype</span><span class="o">=</span>float64<span class="o">)</span>
<span class="w">  </span>status:<span class="w"> </span><span class="m">0</span>
<span class="w"> </span>success:<span class="w"> </span>True
<span class="w">       </span>x:<span class="w"> </span>array<span class="o">([</span><span class="m">4</span>.29208920e-11,<span class="w"> </span><span class="m">4</span>.00000000e+00,<span class="w"> </span><span class="m">2</span>.00000000e+00,<span class="w"> </span><span class="m">1</span>.12695494e-10<span class="o">])</span>

<span class="c1"># scipy==1.12.0</span>
<span class="o">(</span>base<span class="o">)</span><span class="w"> </span>$<span class="w"> </span>python<span class="w"> </span>simplex_method.py
<span class="w">       </span>message:<span class="w"> </span>Optimization<span class="w"> </span>terminated<span class="w"> </span>successfully.<span class="w"> </span><span class="o">(</span>HiGHS<span class="w"> </span>Status<span class="w"> </span><span class="m">7</span>:<span class="w"> </span>Optimal<span class="o">)</span>
<span class="w">        </span>success:<span class="w"> </span>True
<span class="w">         </span>status:<span class="w"> </span><span class="m">0</span>
<span class="w">            </span>fun:<span class="w"> </span>-12.0
<span class="w">              </span>x:<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">0</span>.000e+00<span class="w">  </span><span class="m">4</span>.000e+00<span class="w">  </span><span class="m">2</span>.000e+00<span class="w">  </span><span class="m">0</span>.000e+00<span class="o">]</span>
<span class="w">            </span>nit:<span class="w"> </span><span class="m">3</span>
<span class="w">          </span>lower:<span class="w">  </span>residual:<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">0</span>.000e+00<span class="w">  </span><span class="m">4</span>.000e+00<span class="w">  </span><span class="m">2</span>.000e+00<span class="w">  </span><span class="m">0</span>.000e+00<span class="o">]</span>
<span class="w">                 </span>marginals:<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">5</span>.000e+00<span class="w">  </span><span class="m">0</span>.000e+00<span class="w">  </span><span class="m">0</span>.000e+00<span class="w">  </span><span class="m">3</span>.000e+00<span class="o">]</span>
<span class="w">          </span>upper:<span class="w">  </span>residual:<span class="w"> </span><span class="o">[</span><span class="w">       </span>inf<span class="w">        </span>inf<span class="w">        </span>inf<span class="w">        </span>inf<span class="o">]</span>
<span class="w">                 </span>marginals:<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">0</span>.000e+00<span class="w">  </span><span class="m">0</span>.000e+00<span class="w">  </span><span class="m">0</span>.000e+00<span class="w">  </span><span class="m">0</span>.000e+00<span class="o">]</span>
<span class="w">          </span>eqlin:<span class="w">  </span>residual:<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">0</span>.000e+00<span class="w">  </span><span class="m">0</span>.000e+00<span class="o">]</span>
<span class="w">                 </span>marginals:<span class="w"> </span><span class="o">[</span>-0.000e+00<span class="w"> </span>-3.000e+00<span class="o">]</span>
<span class="w">        </span>ineqlin:<span class="w">  </span>residual:<span class="w"> </span><span class="o">[]</span>
<span class="w">                 </span>marginals:<span class="w"> </span><span class="o">[]</span>
<span class="w"> </span>mip_node_count:<span class="w"> </span><span class="m">0</span>
<span class="w"> </span>mip_dual_bound:<span class="w"> </span><span class="m">0</span>.0
<span class="w">        </span>mip_gap:<span class="w"> </span><span class="m">0</span>.0
</code></pre></div></td></tr></table></div>
<div class="code-footer"><label class="expand" for="__collapse0" tabindex="0" title="展"></label><label class="collapse" for="__collapse0" tabindex="0" title="折"></label></div>
</div>
<p>下面用 Python 编程单纯形算法.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">修正单纯形算法</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">输入</span><span class="err">：</span> <span class="n">初始基本可行解</span> <span class="n">x_0</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span>
<span class="n">输出</span><span class="err">：</span> <span class="n">最优解</span> <span class="n">x</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">x_0</span>
<span class="mf">1.</span> <span class="n">确定</span> <span class="n">A</span> <span class="n">中基阵</span> <span class="n">B</span> <span class="n">对应的指标集</span> <span class="n">I_B</span><span class="p">,</span> <span class="n">c_B</span><span class="p">;</span> <span class="n">非基阵</span> <span class="n">N</span> <span class="n">对应的指标集</span> <span class="n">I_N</span><span class="p">,</span> <span class="n">c_N</span><span class="p">;</span> 
<span class="c1"># 计算 .t() 表示转置 .inv() 表示求逆</span>
<span class="n">Delta</span> <span class="o">=</span> <span class="n">c_N</span><span class="o">.</span><span class="n">t</span><span class="p">()</span> <span class="o">-</span> <span class="n">c_N</span><span class="o">.</span><span class="n">t</span><span class="p">()</span> <span class="o">*</span> <span class="n">B</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span> <span class="o">*</span> <span class="n">N</span><span class="p">;</span>
<span class="c1"># 初始化单纯形表（simplex table）</span>
<span class="n">St</span> <span class="o">=</span> <span class="n">con</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">St</span> <span class="o">=</span> <span class="n">con</span><span class="p">(</span><span class="n">St</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">t</span><span class="p">(),</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 直到 Delta &gt;= 0 时停止迭代</span>
<span class="k">while</span> <span class="p">(</span><span class="ow">not</span> <span class="n">Delta</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">c_N</span><span class="p">[</span><span class="n">Delta</span><span class="o">.</span><span class="n">argmin</span><span class="p">()]</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">inv</span><span class="p">())</span> <span class="o">*</span> <span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;无解&quot;</span><span class="p">)</span> <span class="k">return</span> <span class="n">none</span><span class="p">;</span>
    <span class="c1"># 计算用于 Gauss-Jordan 消元的主元素的位置</span>
    <span class="nb">filter</span> <span class="o">=</span> <span class="n">I_B</span><span class="p">[(</span><span class="n">B</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span> <span class="o">*</span> <span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">])[</span><span class="n">I_B</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)];</span>
    <span class="n">check_list</span> <span class="o">=</span> <span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span> <span class="o">*</span> <span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">])[</span><span class="nb">filter</span><span class="p">])</span>
    <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">I_B</span><span class="p">[</span><span class="nb">filter</span><span class="p">])[</span><span class="n">check_list</span><span class="o">.</span><span class="n">argmin</span><span class="p">()]</span>
    <span class="n">main_ele</span> <span class="o">=</span> <span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">inv</span> <span class="o">*</span> <span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">])[</span><span class="n">r</span><span class="p">]</span>
    <span class="c1"># 下面用主元素 main_ele 对单纯形进行 Gauss-Jordan 消元</span>

    <span class="c1"># 调整基指标和非基指标</span>
<span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
<h4 id="_8">两阶段法<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<p>对于一般的线性规划问题不能很容易地找到基矩阵 <span class="arithmatex">\(B\)</span> ，对于原线性规划问题：</p>
<div class="arithmatex">\[(P)\quad\begin{aligned}
&amp;\min\ c^Tx\\
&amp;s.t.\ Ax=b\\
&amp;\quad\quad x\geq0
\end{aligned}\]</div>
<p>设 <span class="arithmatex">\(A\in \mathbb{R}^{m\times n},\text{rank}(A)=m\)</span> ， <span class="arithmatex">\(b\ge0\)</span> .</p>
<p>两阶段法构造如下的辅助问题：</p>
<div class="arithmatex">\[(T)\quad \begin{aligned}
&amp;\min\quad \sum\limits_{i=n+1}^{n+m}x_i\\
&amp;s.t.\quad \ Ax+x_\alpha=b\\
&amp;\qquad\quad x,x_\alpha\ge0
\end{aligned}\]</div>
<p>则  <span class="arithmatex">\(x\)</span> 为 <span class="arithmatex">\((P)\)</span> 的可行解 <span class="arithmatex">\(\Leftrightarrow\)</span> <span class="arithmatex">\([x,0]^T\)</span> 为 <span class="arithmatex">\((T)\)</span> 的可行解 <span class="arithmatex">\(\Leftrightarrow\)</span> <span class="arithmatex">\((T)\)</span> 的最优值为 <span class="arithmatex">\(0\)</span> .</p>
<p>因此，最开始时可以取 <span class="arithmatex">\(\begin{bmatrix}0 \\ I_\alpha\end{bmatrix}\)</span> 作为辅助问题的基本可行解，用单纯形方法求解得到最优解，如果最优解对应的目标值非 <span class="arithmatex">\(0\)</span> ，则 <span class="arithmatex">\((P)\)</span> 无可行解，否则将会得到原问题的一个基本可行解.</p>
<h4 id="m">M 法<a class="headerlink" href="#m" title="Permanent link">&para;</a></h4>
<p><span class="arithmatex">\(M\)</span> 法引入一个充分大的参数 <span class="arithmatex">\(M\)</span> （可以理解为 <span class="arithmatex">\(+\infty\)</span> ，但是有系数），构造如下的辅助问题：</p>
<div class="arithmatex">\[(M)\quad \begin{aligned}
&amp;\min\quad c^Tx+Me^Tx_\alpha\\
&amp;s.t.\quad\ Ax+x_\alpha=b\\
&amp;\qquad\quad x\ge0,x_\alpha\ge0
\end{aligned}\]</div>
<h4 id="_9">对偶单纯性法<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<p>标准线性规划问题 <span class="arithmatex">\((P)\)</span> 及其<strong>对偶问题</strong> <span class="arithmatex">\((D)\)</span> ：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;(P)\quad \begin{aligned}
&amp;\min\ c^Tx\\
&amp;\ \text{s.t.}\ Ax=b\\
&amp;\quad \quad x\geq0
\end{aligned}\\
\\
&amp;(D)\quad \begin{aligned}
&amp;\max\ b^Ty\\
&amp;\ \text{s.t.}\ A^Ty\leq c
\end{aligned}
\end{aligned}\]</div>
<div class="admonition note">
<p class="admonition-title">弱对偶定理： <span class="arithmatex">\(x,y\)</span> 分别为 <span class="arithmatex">\((P),(D)\)</span> 的可行解，则有 <span class="arithmatex">\(c^Tx\geq b^Ty\)</span> .</p>
</div>
<div class="admonition note">
<p class="admonition-title">强对偶定理：如果 <span class="arithmatex">\((P)\)</span> 有最优解，则 <span class="arithmatex">\(D\)</span> 有最优解，并且<u>两者最优目标值相同</u> .</p>
<p>对偶问题 <span class="arithmatex">\((D)\)</span> 的最优解 <span class="arithmatex">\(y^*=B^{-T}c_B\)</span> .</p>
</div>
<p>在单纯形法中， <span class="arithmatex">\((P)\)</span> 的一个<u>基本可行解</u> <span class="arithmatex">\(x\)</span> 对应的检验向量 <span class="arithmatex">\(\Delta=c_N^T-c_B^TB^{-1}N\geq0\)</span> 时， <span class="arithmatex">\(x\)</span> 为 <span class="arithmatex">\((P)\)</span> 的最优解. </p>
<p>在这种情况下令 <span class="arithmatex">\(y=(B^{-1})^Tc_B\)</span> 可得 <span class="arithmatex">\(c_N^T-y^TN\geq0\)</span> 从而 <span class="arithmatex">\(A^Ty=(B^T\  N^T)y=(c_B\ N^Ty)\leq c\)</span> . 称 <span class="arithmatex">\(y=B^{-T}c_B\)</span> 为 <span class="arithmatex">\(x\)</span> 的<strong>对偶变量</strong>.</p>
<p>对偶单纯形算法如下： #imcomplete-lack-proofs </p>
<ol>
<li><u>选取</u> <span class="arithmatex">\((P)\)</span> 的一个基矩阵 <span class="arithmatex">\(B\)</span> ，使得满足 <span class="arithmatex">\(c_N^T-c_B^TB^{-1}N\geq0\)</span> ，列出单纯形表；</li>
<li>求 <span class="arithmatex">\(\bar{b}_{i_r}=\min\{(B^{-1}b)_{i_j}:j=1,\cdots,m\}\)</span> ，其中基指标集 <span class="arithmatex">\(I_B=\{i_1,\cdots,i_m\}\)</span> ；</li>
<li>若 <span class="arithmatex">\(\bar{b}_{i_r}\geq0\)</span> ，停止，返回上述得到的解；否则继续到步骤 4.</li>
<li>获取 <span class="arithmatex">\(B^{-1}N\)</span> 的第 <span class="arithmatex">\(i_r\)</span> 行，若 <span class="arithmatex">\(e_{i_r}^T(B^{-1}N)\geq0\)</span> ，停止，对偶问题无解；否则继续到步骤 5；</li>
<li>求 <span class="arithmatex">\(k=\arg\max\left\{\frac{c_j-c_B^TB^{-1}a_j}{e_{i_r}^TB^{-1}a_j}:e^{T}_{i_r}B^{-1}a_j&lt;0\right\}\)</span> </li>
<li>以 <span class="arithmatex">\(e^T_{i_r}B^{-1}a_k\)</span> 为主元素（即 <span class="arithmatex">\((B^{-1}N)_{i_r,k}\)</span> ）对单纯形表进行 Gauss-Jordan 消元，并以 <span class="arithmatex">\(k\)</span> 替换 <span class="arithmatex">\(I_B\)</span> 中的 <span class="arithmatex">\(i_r\)</span> ，转到步骤 2.</li>
</ol>
<p>就算法而言，与单纯形算法的区别在于确定 <span class="arithmatex">\(i_r\)</span> 之后确定 <span class="arithmatex">\(k\)</span> 时的计算.</p>
<h2 id="_10">整数线性规划<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h2>
<p><strong>整数线性规划</strong>（ILP）的标准型为：</p>
<div class="arithmatex">\[(P)\quad \begin{aligned}
&amp;\min\ c^Tx\\
&amp;s.t.\ Ax=b\\
&amp;\quad\quad x\geq0\\
&amp;\qquad x_i\in I,i=1,\cdots,n\\
&amp;\qquad I\subset \mathbb{N}
\end{aligned}\]</div>
<p>并定义松弛问题：</p>
<div class="arithmatex">\[(P_0)\quad \begin{aligned}
&amp;\min\ c^Tx\\
&amp;s.t.\ Ax=b\\
&amp;\quad\quad x\geq0
\end{aligned}\]</div>
<p>如果 <span class="arithmatex">\(I=\{0,1\}\)</span> 则称为 <span class="arithmatex">\(0-1\)</span> 规划问题（背包问题）.</p>
<h3 id="_11">分枝界定法<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<h3 id="gemory">Gemory 割平面法<a class="headerlink" href="#gemory" title="Permanent link">&para;</a></h3>
<p>Gemory 割平面法讨论的问题是：</p>
<div class="arithmatex">\[(P)\quad \begin{aligned}
&amp;\min\ c^Tx\\
&amp;s.t.\ Ax=b\\
&amp;\quad\quad x\geq0\\
&amp;\qquad x_i\in \mathbb{N}
\end{aligned}\]</div>
<p>用单纯形法求解松弛问题 <span class="arithmatex">\((P_0)\)</span> 之后得到： <span class="arithmatex">\(\bar{x}=\begin{bmatrix}B^{-1}b  \\ 0\end{bmatrix}\)</span> ，若 <span class="arithmatex">\(\bar{x}\)</span> 为整数变量，则为 <span class="arithmatex">\((P)\)</span> 的解；否则，可以确定该解对应的最优值为 <span class="arithmatex">\((P)\)</span> 的最优值的一个下界. 在这种情况下， <span class="arithmatex">\(B^{-1}b\)</span> 中有正分数分量，考虑单纯形算法结束时的约束条件：</p>
<div class="arithmatex">\[x_B+(B^{-1}N)x_N=B^{-1}b\]</div>
<p>记 <span class="arithmatex">\(I_N\)</span> 为 <span class="arithmatex">\(N\)</span> 的列指标，上式等同于：</p>
<div class="arithmatex">\[x_B+\sum\limits_{j\in I_N}^{}(B^{-1}a_j)x_j=B^{-1}b\]</div>
<p>记作：</p>
<div class="arithmatex">\[x_B+\sum\limits_{j\in I_N}^{}\bar{a}_jx_j=\bar{b}\]</div>
<p>设 <span class="arithmatex">\(B^{-1}b\overset{def}{=}\bar{b}\)</span> 的第 <span class="arithmatex">\(l\)</span> 个分量 <span class="arithmatex">\(\bar{b}_l\)</span> 为分数，松弛问题 <span class="arithmatex">\((P_0)\)</span> 的可行解满足：</p>
<div class="arithmatex">\[x_{B_l}+\sum\limits_{j\in I_N}^{}\bar{a}_{lj}x_j=\bar{b}_l\]</div>
<p>进而由 <span class="arithmatex">\(x_j\ge0\)</span> ：</p>
<div class="arithmatex">\[x_{B_l}+\sum\limits_{j\in I_N}^{}[\bar{a}_{lj}]x_j\leq \bar{b}_l\]</div>
<p>并且因为 <span class="arithmatex">\((P)\)</span> 的可行解满足上不等式以及为整数：</p>
<div class="arithmatex">\[x_{B_l}+\sum\limits_{j\in I_N}^{}[\bar{a}_{lj}]x_j\leq [\bar{b_l}]\]</div>
<p>从而得到：</p>
<div class="arithmatex">\[\sum\limits_{j\in I_N}^{}(\bar{a}_{lj}-[\bar{a}_{lj}])x_j\geq \bar{b}_l-[\bar{b}_l]\]</div>
<p>因此，可以引入一松弛变量 <span class="arithmatex">\(s\ge0\)</span> ，得到一个新的约束等式：</p>
<div class="arithmatex">\[\sum\limits_{j\in I_N}^{}(\bar{a}_{lj}-[\bar{a}_{lj}])x_j\ge \bar{b}_l-[\bar{b}_l]\]</div>
<p>将其加入到原先的方程中，这会将 <span class="arithmatex">\(\begin{bmatrix}B^{-1}b \\ 0\end{bmatrix}\)</span> 排除在外，并且排除了其他不可能是最优解的点，这个方程称为<strong>割平面方程</strong>.</p>
<p>Gemory 割平面算法如下：</p>
<ol>
<li>用单纯形法求解 <span class="arithmatex">\((P_0)\)</span> ，若无解，返回无解；若求得 <span class="arithmatex">\((P_0)\)</span> 的解 <span class="arithmatex">\(x_0\)</span> ， <span class="arithmatex">\(x_0\)</span> 是整数向量，则返回 <span class="arithmatex">\(x_0\)</span> ；否则转步骤 2；</li>
<li>取 <span class="arithmatex">\(x_0\)</span> 的非整数分量 <span class="arithmatex">\(\bar{b}\)</span> ，求割平面方程；</li>
<li>将割平面方程加入到单纯形表中；用对偶单纯形算法求解问题. 若问题无界，停止；若解为整数解，返回；否则转入步骤 2.</li>
</ol>
<h2 id="_12">无约束优化<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h2>
<p>无约束优化的形式为：</p>
<div class="arithmatex">\[\min\ f(x),f\in C(\mathbb{R})\]</div>
<div class="arithmatex">\[\begin{aligned}
&amp;x_{k+1}=x_k+\alpha_kd_k\\
&amp;\text{s.t.}\ f(x_{k+1})&lt;f(x_k)
\end{aligned}\]</div>
<p>若记 <span class="arithmatex">\(\varphi(\alpha)=f(x_k+\alpha d_k)\)</span> ，则上式可以表示为：</p>
<div class="arithmatex">\[\varphi(\alpha_k)&lt;\varphi(0)\]</div>
<p>因此求解的 <span class="arithmatex">\(\alpha_k\)</span> 即为对应的 <span class="arithmatex">\(\varphi\)</span> 值小于原点对应的 <span class="arithmatex">\(\varphi\)</span> 值的点.</p>
<p><strong>下降方向</strong>（descent direction） ： <span class="arithmatex">\(d_k\in\mathbb{R}^n\)</span> ；<br />
<strong>步长</strong>（step length） <span class="arithmatex">\(\alpha_k\)</span> ；</p>
<h3 id="_13">线性搜索<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<p><strong>线性搜索</strong>采取迭代算法不断获得新的点，以接近最优值：</p>
<p>对于 <span class="arithmatex">\(x_k\)</span> ，确定搜索方向 <span class="arithmatex">\(d_k\)</span> 和步长 <span class="arithmatex">\(\alpha_k\)</span> ，下一个迭代点 <span class="arithmatex">\(x_{k+1}=x_k+\alpha_k d_k\)</span> .</p>
<p>要求 <span class="arithmatex">\(d_k\)</span> 为下降方向 #imcomplete ，即 <span class="arithmatex">\(d_k^T \nabla f(x_k)&lt;0\)</span> .</p>
<p>线性搜索算法需要解决两个问题： <span class="arithmatex">\(d_k\)</span> 的选取和 <span class="arithmatex">\(\alpha_k\)</span> 的选取；</p>
<p>假设已经确定了 <span class="arithmatex">\(d_k\)</span> ，构造辅助函数：</p>
<div class="arithmatex">\[\varphi(\alpha)=f(x_k+\alpha d_k)\]</div>
<p>注意到 <span class="arithmatex">\(\varphi(\alpha)\)</span> 即为 <span class="arithmatex">\(f|_{\{x_k+\alpha d_k:\alpha&gt;0\}}\)</span> ，且是一元函数，因此求解步长 <span class="arithmatex">\(\alpha_k\)</span> 使其满足 <span class="arithmatex">\(\varphi(\alpha_k)&lt;\varphi(0)\)</span> 相当于在射线 <span class="arithmatex">\(\{x_k+\alpha d_k:\alpha&gt;0\}\)</span> 上搜索得到 <span class="arithmatex">\(f\)</span> 的一个小于 <span class="arithmatex">\(f(0)\)</span> 的值，线性搜索因此得名. </p>
<div class="admonition tip">
<p class="admonition-title">线性搜索算法将多元函数无约束问题转化为一元函数无约束问题，在这种情况下，针对 <span class="arithmatex">\(\varphi(\alpha)\)</span> 搜索只有两个方向， <span class="arithmatex">\(d_k\in\{-1,1\}\)</span> .</p>
</div>
<p><span class="arithmatex">\(\alpha_k\)</span> 的选取应该能够充分地降低 <span class="arithmatex">\(\varphi\)</span> 的值，同时不应在确定 <span class="arithmatex">\(\alpha_k\)</span> 上浪费太多时间.</p>
<p>一种最理想的情况是： <span class="arithmatex">\(\alpha_k=\arg\min_{\alpha&gt;0}\varphi(\alpha)\)</span> ，即最优步长，获取最优步长的线性搜索算法称为<strong>精确线性搜索算法</strong>，显然这不是必要的且难以实现. 实际应用中通常采用<strong>非精确线性搜索算法</strong>，要求 <span class="arithmatex">\(\varphi(\alpha)\)</span> 或者 <span class="arithmatex">\(\alpha\)</span> 满足某些性质以确定步长 <span class="arithmatex">\(\alpha_k\)</span> .</p>
<h4 id="_14">线性搜索准则<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<p><strong>线性搜索准则</strong>是非精确线性搜索算法中对于 <span class="arithmatex">\(\alpha\)</span> （而不是对于 <span class="arithmatex">\(\varphi(\alpha)\)</span> ）的限制条件，将直接影响线性搜索算法是否收敛以及快慢.</p>
<div class="arithmatex">\[\text{Armijo})\quad f(x_k+\alpha d_k)\leq f(x_k)+c_1\alpha \nabla f(x_k)^Td_k,c_1\in(0,1)\]</div>
<p>即为：</p>
<div class="arithmatex">\[\text{Armijo}')\quad \varphi(\alpha)\leq \varphi(0)+c_1 \varphi'(0)\cdot\alpha\]</div>
<p>Armijo 准则要求 <span class="arithmatex">\((\alpha,\varphi(\alpha))\)</span> 应在直线 <span class="arithmatex">\(\{\varphi(0)+c_1 \nabla f(x_k)^Td_k \alpha:\alpha\geq0\}\)</span> 下方，注意要求 <span class="arithmatex">\(d_k\)</span> 是下降方向，因此 <span class="arithmatex">\(\nabla f(x_k)^Td_k&lt;0\)</span> ，所以 <span class="arithmatex">\(\varphi(\alpha)\leq \varphi(0)\)</span> ，这就保证 <span class="arithmatex">\(\varphi(\alpha)\)</span> 下降.</p>
<p>通常选取 <span class="arithmatex">\(c_1=10^{-3}\)</span> 或者其他很小的数，这样可以很容易地满足 Armijo 准则. 但是 Armijo 准则并不能保证步长充分大（下降充分大），取一非常接近于 <span class="arithmatex">\(0\)</span> 的 <span class="arithmatex">\(\alpha\)</span> 即可. 因此通常需要和其他准则配合.</p>
<div class="admonition tip">
<p class="admonition-title">因为 <span class="arithmatex">\(d_k\)</span> 是下降方向，所以总能够找到 <span class="arithmatex">\(\alpha\)</span> 满足 Armijo 准则. #issue</p>
</div>
<div class="admonition note">
<p class="admonition-title">回退法确定满足 Armijo 准则的步长.</p>
<p>首先给定 <span class="arithmatex">\(\alpha_0\)</span> ， <span class="arithmatex">\(\gamma\in(0,1)\)</span> 初始化 <span class="arithmatex">\(\alpha\leftarrow \alpha_0\)</span> ；当 <span class="arithmatex">\(\alpha\)</span> 不满足 Armijo 时： <span class="arithmatex">\(\alpha\leftarrow \gamma \alpha\)</span> . 最终输出 <span class="arithmatex">\(\alpha_k\leftarrow \alpha\)</span> .</p>
</div>
<p>Armijo 准则要求 <span class="arithmatex">\((\alpha,\varphi(\alpha))\)</span> 在直线 <span class="arithmatex">\(\{\varphi(0)+c \nabla f(x_k)^Td_k \alpha:\alpha\geq0\}\)</span> 的下方，自然地，也可以要求其在某条直线的上方，这样可以保证 <span class="arithmatex">\(\alpha\)</span> 不会过小. <strong>Goldstein</strong> 准则（或 Armijo - Goldstein 准则）：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;\text{Goldstein 1)}\quad f(x_k+\alpha d_k)\leq f(x_k)+c \alpha \nabla f(x_k)^Td_k\\
&amp;\text{Goldstein 2)}\quad f(x_k+\alpha d_k)\geq f(x_k)+(1-c)\alpha \nabla f(x_k)^Td_k
\end{aligned}\]</div>
<p>其中 <span class="arithmatex">\(c\in(0,\frac{1}{2})\)</span> .</p>
<p>Goldstein 要求 <span class="arithmatex">\((\alpha,\varphi(\alpha))\)</span> 在下面两条直线之间：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;l_1:\quad \{(\alpha,\varphi(\alpha)+c \varphi'(0)\cdot \alpha):\alpha\ge0\}\\
&amp;l_2:\quad \{(\alpha,\varphi(\alpha)+(1-c)\varphi'(0)\cdot \alpha):\alpha\geq0\}
\end{aligned}\]</div>
<p>可以采用回退法确定满足 Goldstein 准则的步长. 首先确定 Goldstein 准则成立的区间 <span class="arithmatex">\([a_0,b_0]\)</span> ，给定 <span class="arithmatex">\(\alpha_0\in[a_0,b_0],c\in(0,\frac{1}{2}),\gamma&gt;1\)</span> ， <span class="arithmatex">\(k\leftarrow 0\)</span> .</p>
<p>当 <span class="arithmatex">\(\alpha_0\)</span> 不满足 Goldstein 1) 时： </p>
<div class="arithmatex">\[\begin{aligned}
&amp;a_{k+1}\leftarrow a_k\\
&amp;b_{k+1}\leftarrow \alpha_k\\
&amp;\alpha_{k+1}\leftarrow \frac{a_{k+1}+b_{k+1}}{2}\\
&amp;k\leftarrow k+1
\end{aligned}\]</div>
<p>当 <span class="arithmatex">\(\alpha_0\)</span> 不满足 Goldstein 2) 时：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;a_{k+1}\leftarrow \alpha_k\\
&amp;b_{k+1}\leftarrow b_k\\
&amp;\alpha_{k+1}\leftarrow t \alpha_k\\
&amp;k\leftarrow k+1
\end{aligned}\]</div>
<details class="example">
<summary>使用 Goldstein 准则求 <span class="arithmatex">\(\varphi(t)=-2t^3+21t^2-60t+50\)</span> 在 <span class="arithmatex">\(t_0=0.5\)</span> 的一个步长， <span class="arithmatex">\(\rho=0.1\)</span> .</summary>
<p>解：优化函数为 <span class="arithmatex">\(\varphi(t)\)</span> ，并设置超参树 <span class="arithmatex">\(\rho=0.1\)</span> . <span class="arithmatex">\(\varphi'(t)=-6t^2+42t-60\)</span> ， <span class="arithmatex">\(\varphi'(0.5)&lt;0\)</span> ，因此下降方向为 <span class="arithmatex">\(d=+1\)</span> .  [[2422We121404]]</p>
<p>因此有如下的 Goldstein 准则：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;\varphi(t_0+\alpha)\leq \varphi(t_0)+\rho \alpha \varphi'(t_0)\\
&amp;\varphi(t_0+\alpha)\geq \varphi(t_0)+(1-\rho)\alpha \varphi'(t_0)\\
\end{aligned}\]</div>
</details>
<p>设 <span class="arithmatex">\(f\in C^1(\mathbb{R}^n)\)</span> ，并设 <span class="arithmatex">\(f\)</span> 在 <span class="arithmatex">\(x_k\)</span> 处的下降方向 <span class="arithmatex">\(d_k\)</span> 满足： <span class="arithmatex">\(g_k^Td_k&lt;0\)</span> .</p>
<div class="arithmatex">\[f(x_k+\alpha d_k)=f(x_k)+\alpha\nabla^Tf(x_k)d_k+\frac{\mathcal{o}(\alpha)}{\alpha}\]</div>
<p>注意到右式的线性部分： <span class="arithmatex">\(f(x_k)+\alpha\nabla^Tf(x_k)d_k\)</span> ，考虑： </p>
<div class="arithmatex">\[\begin{aligned}
&amp;f(x_k+\alpha d_k)\leq f(x_k)+\rho_1\alpha_kg_k^Td_k\quad (1)\\
&amp;-\nabla f(x_k+\alpha_kd_k)^Td_k\leq -\rho_2 g_k^Td_k\quad (2)\\
&amp;0&lt;\rho_1&lt;\rho_2&lt;1
\end{aligned}\]</div>
<p>其中 <span class="arithmatex">\((1)\)</span> 是上述提到的 Armijo 准则， <span class="arithmatex">\((2)\)</span> 被称为曲率条件（curvatur condition）</p>
<div class="admonition tip">
<p class="admonition-title">参数选择</p>
<p><span class="arithmatex">\(\rho_1\)</span> 通常取很小的值， <span class="arithmatex">\(\rho_2\)</span> 则取较大的值.</p>
</div>
<h4 id="_15">黄金分割法<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h4>
<p>设 <span class="arithmatex">\(\varphi(\alpha)\)</span> 定义在 <span class="arithmatex">\([a,b]\)</span> 上，如果存在唯一的 <span class="arithmatex">\(\alpha^*\in(a,b)\)</span> 使得 <span class="arithmatex">\(\varphi\)</span> 在 <span class="arithmatex">\([a,\alpha^*]\)</span> 上严格单调递减，在 <span class="arithmatex">\([\alpha^*,b]\)</span> 上严格单调增加，则称 <span class="arithmatex">\(\varphi\)</span> 为单峰函数. </p>
<p>任取 <span class="arithmatex">\(\lambda,\mu\in(a,b)\)</span> ：</p>
<ol>
<li>如果 <span class="arithmatex">\(\varphi(\lambda)\leq \varphi(\mu)\)</span> 则 <span class="arithmatex">\(\alpha^*\in[a,\mu]\)</span> ；</li>
<li>如果 <span class="arithmatex">\(\varphi(\lambda)&gt;\varphi(\mu)\)</span> 则 <span class="arithmatex">\(\alpha^*\in[\lambda,b]\)</span> .</li>
</ol>
<p>黄金分割法：</p>
<ol>
<li>初始化区间 <span class="arithmatex">\([a_1,b_1]\)</span> ，给定精度 <span class="arithmatex">\(\epsilon\geq0\)</span> . 计算：</li>
</ol>
<div class="arithmatex">\[\begin{aligned}
&amp;\lambda_1=a_1+0.382(b_1-a_1)\\
&amp;\mu_1=a_1+0.618(b_1-a_1)
\end{aligned}\]</div>
<ol>
<li>如果 <span class="arithmatex">\(\varphi(\lambda_k)&gt;\varphi(\mu_k)\)</span> ，转步骤 <span class="arithmatex">\(3.\)</span> ，否则转入步骤 <span class="arithmatex">\(4.\)</span></li>
<li>若 <span class="arithmatex">\(b_k-a_k\leq \epsilon\)</span> ，停止，输出 <span class="arithmatex">\(x^*=\mu_k\)</span> ；否则 <span class="arithmatex">\(a_{k+1}=\lambda_k,b_{k+1}=b_k\)</span></li>
</ol>
<div class="collapse-code"><input checked="checked" id="__collapse1" name="__collapse1" type="checkbox" /><div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">黄金分割法</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">exp</span>

<span class="k">def</span> <span class="nf">golden_section_search</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">ep</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
    <span class="n">golden_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="c1"># 初始化 lam, mu</span>
    <span class="n">lam</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">golden_ratio</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">golden_ratio</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>

    <span class="c1"># 计算 f(lamda_1) f(mu_1)</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>
    <span class="n">f2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>

    <span class="c1"># 直到小于精度停止</span>
    <span class="k">while</span> <span class="n">b</span> <span class="o">-</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="n">ep</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">f1</span> <span class="o">&lt;</span> <span class="n">f2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mu</span> <span class="o">-</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">ep</span><span class="p">:</span> <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">mu</span>
            <span class="n">mu</span> <span class="o">=</span> <span class="n">lam</span>
            <span class="n">lam</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">golden_ratio</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">f2</span> <span class="o">=</span> <span class="n">f1</span>
            <span class="n">f1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a: </span><span class="si">{</span><span class="n">a</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, b: </span><span class="si">{</span><span class="n">b</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, b-a: </span><span class="si">{</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">lam</span>
            <span class="n">lam</span> <span class="o">=</span> <span class="n">mu</span>
            <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">golden_ratio</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">f1</span> <span class="o">=</span> <span class="n">f2</span>
            <span class="n">f2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a: </span><span class="si">{</span><span class="n">a</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, b: </span><span class="si">{</span><span class="n">b</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, b-a: </span><span class="si">{</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">lam</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>


<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">x_min</span><span class="p">,</span> <span class="n">min_value</span> <span class="o">=</span> <span class="n">golden_section_search</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;近似极小点:&quot;</span><span class="p">,</span> <span class="n">x_min</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;近似极小值:&quot;</span><span class="p">,</span> <span class="n">min_value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="code-footer"><label class="expand" for="__collapse1" tabindex="0" title="展"></label><label class="collapse" for="__collapse1" tabindex="0" title="折"></label></div>
</div>
<p>程序运行输出（注：输出时限制了小数点后的位数（计算时没有，按照默认位数），并打印了每一次迭代的情况）：</p>
<p><strong>结果</strong>：在限制 <span class="arithmatex">\(\epsilon=1\times 10^{-6}\)</span> ，最终的近似极小值为 <span class="arithmatex">\(1.27\times 10^{-7}\)</span> ，接近 <span class="arithmatex">\(0\)</span> .</p>
<p>另一个使用该函数的例子：</p>
<div class="collapse-code"><input checked="checked" id="__collapse2" name="__collapse2" type="checkbox" /><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">golden_search</span>

<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">**</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># 这里打印了函数，确认其是单峰的</span>
<span class="c1"># plt.plot(x, f(x))</span>
<span class="c1"># plt.xlabel(&#39;x&#39;)</span>
<span class="c1"># plt.ylabel(&#39;f(x)&#39;)</span>
<span class="c1"># plt.grid(True)</span>
<span class="c1"># plt.show()</span>

<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">x_min</span><span class="p">,</span> <span class="n">min_value</span> <span class="o">=</span> <span class="n">golden_search</span><span class="o">.</span><span class="n">golden_section_search</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;极大值点: &quot;</span><span class="p">,</span> <span class="n">x_min</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;极大值: &quot;</span><span class="p">,</span> <span class="o">-</span> <span class="n">min_value</span><span class="p">)</span>
</code></pre></div>
<div class="code-footer"><label class="expand" for="__collapse2" tabindex="0" title="展"></label><label class="collapse" for="__collapse2" tabindex="0" title="折"></label></div>
</div>
<p>结果：在限制 <span class="arithmatex">\(\epsilon=1\times 10^{-6}\)</span> ，极大值约为为 <span class="arithmatex">\(4.11\times10^{10}\)</span> .</p>
<h4 id="_16">精确线性搜索<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h4>
<h3 id="_17">多元无约束优化问题<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<h4 id="_18">最速下降法<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h4>
<p>考虑无约束优化问题：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;\min f(x),f\in C^1(\mathbb{R}^n)
\end{aligned}\]</div>
<div class="admonition example">
<p class="admonition-title">取初始点 <span class="arithmatex">\(x_0=[0,0]^T\)</span> ，设定精确误差 <span class="arithmatex">\(\epsilon=0.01\)</span> ，利用最速下降法求解下面的优化问题： <span class="arithmatex">\(\min_{x\in \mathbb{R}^2}\quad x_1^2-2x_1x_2+4x_2^2+x_1-3x_2\)</span> .</p>
</div>
<p>回顾： <a href="../MA/#极值理论">MA#极值理论</a></p>
<div class="arithmatex">\[\nabla f(x_1,x_2)=[2x_1-2x_2+1,-2x_1+8x_2-3]^T\]</div>
<p>下面采用的是最速下降法，使用 Goldstein 算法确定步长：</p>
<div class="collapse-code"><input checked="checked" id="__collapse3" name="__collapse3" type="checkbox" /><div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Goldstein + 最速下降</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">varphi</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">x_1</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">x_2</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x_1</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">x_2</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">x_1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x_1</span> <span class="o">*</span> <span class="n">x_2</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">x_2</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x_1</span> <span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="n">x_2</span>

<span class="k">def</span> <span class="nf">d</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="n">x_1</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x_2</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x_1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x_2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">x_2</span> <span class="o">-</span><span class="mi">3</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">varphi_p</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="o">-</span><span class="n">d</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>

<span class="c1"># 按照算法 4.14 Goldstein 算法设置的两个超参数，符号是一致的</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">t</span>  <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># 计算 Goldstein 条件</span>
<span class="k">def</span> <span class="nf">goldstein_condition</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">rho</span> <span class="o">=</span> <span class="n">rho</span><span class="p">):</span>
    <span class="n">condition_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">varphi</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="o">+</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">varphi_p</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="n">varphi</span><span class="p">(</span><span class="n">arr</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>
    <span class="c1"># if not condition_1:</span>
    <span class="c1">#     print(f&quot;Condition 1 not satisfied&quot;)</span>
    <span class="n">condition_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">varphi</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">varphi_p</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="n">varphi</span><span class="p">(</span><span class="n">arr</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>
    <span class="c1"># if not condition_2:</span>
    <span class="c1">#     print(f&quot;Condition 2 not satisfied&quot;)</span>
    <span class="k">return</span> <span class="n">condition_1</span><span class="p">,</span> <span class="n">condition_2</span>

<span class="k">def</span> <span class="nf">goldstein_cal_step</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">rho</span><span class="o">=</span><span class="n">rho</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">ep</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">ep</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">condition_1</span><span class="p">,</span> <span class="n">condition_2</span> <span class="o">=</span> <span class="n">goldstein_condition</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">rho</span><span class="p">)</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="p">(</span><span class="n">condition_1</span> <span class="o">&amp;</span> <span class="n">condition_2</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition_1</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">alpha</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition_2</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">alpha</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="n">t</span> <span class="o">*</span> <span class="n">alpha</span>
        <span class="n">condition_1</span><span class="p">,</span> <span class="n">condition_2</span> <span class="o">=</span> <span class="n">goldstein_condition</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">rho</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">alpha</span>

<span class="k">def</span> <span class="nf">plot_func</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_max</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># 下面是试图通过图像找步长编写的函数，但是发现人工太慢了...</span>
<span class="k">def</span> <span class="nf">plot_goldstein</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">rho</span> <span class="o">=</span> <span class="n">rho</span><span class="p">,</span> <span class="n">x_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_max</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">line_1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">alpha</span><span class="p">:</span> <span class="n">varphi</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="o">+</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">varphi_p</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="n">line_2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">alpha</span><span class="p">:</span> <span class="n">varphi</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">varphi_p</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="n">graph_varphi</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">alpha</span><span class="p">:</span> <span class="n">varphi</span><span class="p">(</span><span class="n">arr</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">d</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>
    <span class="n">plot_func</span><span class="p">(</span><span class="n">line_1</span><span class="p">,</span> <span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)</span>
    <span class="n">plot_func</span><span class="p">(</span><span class="n">line_2</span><span class="p">,</span> <span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)</span>
    <span class="n">plot_func</span><span class="p">(</span><span class="n">graph_varphi</span><span class="p">,</span> <span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">update_arr</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">arr</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">goldstein_steep</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="c1"># 这里这个 1 是我提前通过绘制图像确定的</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">goldstein_cal_step</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">&gt;=</span> <span class="mf">1e-03</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;当步长小于 1e-03 时停止迭代&quot;&quot;&quot;</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">goldstein_cal_step</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">update_arr</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha: </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, x: </span><span class="si">{</span><span class="n">arr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">arr</span>
</code></pre></div></td></tr></table></div>
<div class="code-footer"><label class="expand" for="__collapse3" tabindex="0" title="展"></label><label class="collapse" for="__collapse3" tabindex="0" title="折"></label></div>
</div>
<p>程序输出（在终端的 Python 交互模式下运行，Linux 环境，用的是 python3）：</p>
<div class="collapse-code"><input checked="checked" id="__collapse4" name="__collapse4" type="checkbox" /><div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">程序输出</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code>$<span class="w"> </span>python3<span class="w"> </span>-i<span class="w"> </span>steepGoldstein.py
&gt;&gt;&gt;<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>np.array<span class="o">([</span><span class="m">0</span>,0<span class="o">])</span>
&gt;&gt;&gt;<span class="w"> </span>goldstein_steep<span class="o">(</span>x<span class="o">)</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.1250875<span class="w">  </span><span class="m">0</span>.3752625<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.12499994<span class="w">  </span><span class="m">0</span>.34370605<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.50005,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.15629708<span class="w">  </span><span class="m">0</span>.34388193<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.1562523<span class="w">   </span><span class="m">0</span>.33592016<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.50005,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16408062<span class="w">  </span><span class="m">0</span>.33598723<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16406365<span class="w">  </span><span class="m">0</span>.33397844<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.50005,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16602176<span class="w">  </span><span class="m">0</span>.33400104<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16601605<span class="w">  </span><span class="m">0</span>.33349421<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.50005,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16650584<span class="w">  </span><span class="m">0</span>.33350133<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16650405<span class="w">  </span><span class="m">0</span>.33337345<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.50005,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16662656<span class="w">  </span><span class="m">0</span>.3333756<span class="w"> </span><span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16662602<span class="w">  </span><span class="m">0</span>.33334334<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.50005,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16665667<span class="w">  </span><span class="m">0</span>.33334397<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16665651<span class="w">  </span><span class="m">0</span>.33333583<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.50005,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666417<span class="w">  </span><span class="m">0</span>.33333601<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666413<span class="w">  </span><span class="m">0</span>.33333396<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.50005,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666604<span class="w">  </span><span class="m">0</span>.33333401<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666603<span class="w">  </span><span class="m">0</span>.33333349<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.50005,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666651<span class="w">  </span><span class="m">0</span>.3333335<span class="w"> </span><span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666651<span class="w">  </span><span class="m">0</span>.33333337<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.50005,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666663<span class="w">  </span><span class="m">0</span>.33333338<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666663<span class="w">  </span><span class="m">0</span>.33333334<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.50005,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666666<span class="w">  </span><span class="m">0</span>.33333334<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666666<span class="w">  </span><span class="m">0</span>.33333334<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333334<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.06259374999999999,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.039183593749999995,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.250075,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.50005,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333334<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333334<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.09389062499999998,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.06259374999999999,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.5001720825195313,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333334<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333334<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.250075,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.250075,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.50015,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.1250875,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333333<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.250075,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333334<span class="o">]</span>
alpha:<span class="w"> </span><span class="m">0</span>.0003441162109375,<span class="w"> </span>x:<span class="w"> </span><span class="o">[</span>-0.16666667<span class="w">  </span><span class="m">0</span>.33333334<span class="o">]</span>
array<span class="o">([</span>-0.16666667,<span class="w">  </span><span class="m">0</span>.33333334<span class="o">])</span>
&gt;&gt;&gt;<span class="w"> </span>
</code></pre></div></td></tr></table></div>
<div class="code-footer"><label class="expand" for="__collapse4" tabindex="0" title="展"></label><label class="collapse" for="__collapse4" tabindex="0" title="折"></label></div>
</div>
<p>最终的解为： <span class="arithmatex">\([-0.16666667,  0.33333334]\)</span> ，即为 <span class="arithmatex">\([-1/6,1/3]\)</span> （和手算（由 <span class="arithmatex">\(H_f(X_0)&gt;0,\nabla f(X_0)=0\)</span> 得到）的一致）</p>
<div class="admonition question">
<p class="admonition-title">从上面的输出可以看到算法早就收敛了，但是直到步长小于 <span class="arithmatex">\(0.001\)</span> 才停止，有没有可以解决这一问题的方法？比如早停？ #imcomplete-further-wanted</p>
</div>
<div class="admonition example">
<p class="admonition-title">已知 Rosenbrock 函数： <span class="arithmatex">\(f(x)=100(x_2-x_1^2)^2+(1-x_1)^2\)</span> ，求 <span class="arithmatex">\(\nabla f(x),\nabla^2f(x)\)</span> ，说明 <span class="arithmatex">\(x^*=[1,1]^T\)</span> 是这个函数的<u>唯一局部极小点</u>，并且 <span class="arithmatex">\(\nabla^2f(x)\)</span> 在这个点是正定的.</p>
</div>
<p>解：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;\nabla f=[-400(x_2-x_1^2)x_1-2(1-x_1),200(x_2-x_1^2)]^T\\
&amp;\nabla^2f=\begin{bmatrix}-400x_2+1200x_1^2+2&amp; -400x_1\\ -400x_1 &amp;200\end{bmatrix}
\end{aligned}\]</div>
<div class="arithmatex">\[\nabla^2f(x^*)=\begin{bmatrix}802&amp; -400 \\ -400  &amp;200\end{bmatrix}\]</div>
<p>计算得到 <span class="arithmatex">\(\nabla^2f(x^*)\)</span> 的两个特征值均大于 <span class="arithmatex">\(0\)</span> ，因此正定；</p>
<p>下面说明唯一性：任何极值点都应当满足 <span class="arithmatex">\(\nabla f=0\)</span> ，求解得到： <span class="arithmatex">\([1,1]^T\)</span> .</p>
<div class="admonition warning">
<p class="admonition-title">上述， <span class="arithmatex">\(f\)</span> 并不是一个凸函数：因为 <span class="arithmatex">\(H_f(X)\)</span> 对于所有点（e.g. <span class="arithmatex">\([0,1]\)</span> ）不总是半正定的.</p>
<p>因此，所求得的 <span class="arithmatex">\([1,1]^T\)</span> 不一定是全局最优点.</p>
</div>
<hr />
<p>非局部最小值的驻点（一阶导数为 <span class="arithmatex">\(0\)</span> 的点）称为<strong>鞍点</strong>. 数学含义是： 目标函数在此点上的梯度（一阶导数）值为 0， 但从改点出发的一个方向是函数的极大值点，而在另一个方向是函数的极小值点.</p>
<div class="admonition note">
<p class="admonition-title">鞍点的充分条件：函数在一阶导数为零处（驻点）的黑塞矩阵为不定矩阵。</p>
</div>
<div class="admonition example">
<p class="admonition-title">已知函数 <span class="arithmatex">\(f(x)=8x_1+12x_2+x_1^2-2x_2^2\)</span> ，说明其只有一个驻点，并且这个点既不是最小值点，也不是最大值点，而是这个函数的鞍点. 画出 <span class="arithmatex">\(f\)</span> 的轮廓线.</p>
</div>
<p>证明：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;\nabla f=[8+2x_1,12-4x_2]^T=0\\
&amp;\nabla^2 f=\begin{bmatrix}2 &amp; 0  \\ 0 &amp; -4\end{bmatrix}
\end{aligned}\]</div>
<p>得到： <span class="arithmatex">\([-4,3]^T\)</span> . 然而 <span class="arithmatex">\(\nabla^2f\)</span> 为不定矩阵，所以 <span class="arithmatex">\([-4,3]^T\)</span> 是鞍点.</p>
<p>下面用 Sage 绘制函数 <span class="arithmatex">\(f\)</span> 的轮廓线：</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">绘制轮廓线</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x1, x2&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x2</span><span class="o">^</span><span class="mi">2</span>
<span class="n">contour_plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">contours</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>![[contours.png|300]]</p>
<details class="example">
<summary><span class="arithmatex">\(a\)</span> 是给定的 <span class="arithmatex">\(n\)</span> 维向量， <span class="arithmatex">\(A\)</span> 是给定的 <span class="arithmatex">\(n\)</span> 阶对称矩阵，计算 <span class="arithmatex">\(f_1(x)=a^TAx,f_2(x)=x^TAx\)</span> 的梯度和 Hesse 阵.</summary>
</details>
<p>解：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;\nabla f_1(x)=\begin{bmatrix}\sum\limits_{k=1}^{n}A_{k1}a_k &amp; \cdots  &amp; \sum\limits_{k=1}^{n}A_{kn}a_k\end{bmatrix}=a^TA\\
&amp;\nabla^2f_1(x)=0\\
&amp;\\
&amp;f_2(x)=\begin{bmatrix}\sum\limits_{l=1}^{n}\sum\limits_{k=1}^{n}(A_{k1}x_kx_l) &amp; \cdots &amp; \sum\limits_{l=1}^{n}\sum\limits_{k=1}^{n}(A_{kn}x_kx_l)\end{bmatrix}\\
&amp;\nabla f_2(x)=\begin{bmatrix}\end{bmatrix}
\end{aligned}\]</div>
<p>| #imcomplete </p>
<h4 id="newton">Newton 迭代法<a class="headerlink" href="#newton" title="Permanent link">&para;</a></h4>
<div class="admonition example">
<p class="admonition-title">使用 Newton 法求解： <span class="arithmatex">\(\min_{x\in \mathbb{R}}\ f(x)=0.5[(x+1)^3+x^2]^2-3\)</span> 的所有极小点.</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Newton</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">);</span>

<span class="c1"># 定义 Newton 迭代函数</span>
<span class="n">NewtonIt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="n">f</span> <span class="o">/</span> <span class="n">df</span><span class="p">)(</span><span class="n">x</span><span class="p">);</span>

<span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">n_iter</span> <span class="o">=</span> <span class="mi">100</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iter</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">N</span><span class="p">(</span><span class="n">NewtonIt</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">digits</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;...</span><span class="se">\n</span><span class="s2">最优值为: &quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>程序输出（只打印了前 10 次迭代的结果，但发现很快就收敛了）</p>
<div class="highlight"><pre><span></span><code><span class="mi">1</span>
<span class="mf">0.70238095238095243911</span>
<span class="mf">0.48842897036899579621</span>
<span class="mf">0.36779232931902688941</span>
<span class="mf">0.33099276491496676389</span>
<span class="mf">0.32799604485073835525</span>
<span class="mf">0.32797749905441364593</span>
<span class="mf">0.32797749834862277574</span>
<span class="mf">0.32797749834862277574</span>
<span class="mf">0.32797749834862277574</span>
<span class="o">...</span>
<span class="n">最优值为</span><span class="p">:</span>  <span class="mf">0.32797749834862277574</span>
</code></pre></div>
<p>多元函数的 Newton 法：</p>
<p>考虑： <span class="arithmatex">\(\min\ f(x)\quad f\in C^2(\mathbb{R}^2)\)</span> .</p>
<p>对于迭代点 <span class="arithmatex">\(x^k\)</span> ，将 <span class="arithmatex">\(f\)</span> 在 <span class="arithmatex">\(x^k\)</span> Taylor 展开得到：</p>
<div class="arithmatex">\[f(x)=f(x^k)+\nabla f(x^k)^T(x-x^k)+\frac{1}{2}(x-x^k)^T\nabla^2f(x^k)(x-x^k)+\mathcal{o}(\lVert x-x^k\rVert_2^2)\]</div>
<p>迭代：</p>
<div class="arithmatex">\[x^{k+1}\leftarrow x^k-(\nabla^2f(x^k))^{-1}\nabla f(x^k)\]</div>
<div class="admonition example">
<p class="admonition-title">用最速下降法、 Newton 法和阻尼 Newton 法求解： <span class="arithmatex">\(\min x_1^2+2x_2^2\)</span> .</p>
</div>
<p>Newton 法：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;\nabla f=\begin{bmatrix}2x_1 \\ 4x_2\end{bmatrix}\\
&amp;\nabla^2 f=\begin{bmatrix}2 &amp;  0  \\ 0 &amp; 4\end{bmatrix}\\
&amp;\nabla^2f^{-1}=\begin{bmatrix}\frac{1}{2} &amp; 0 \\ 0 &amp; \frac{1}{4}\end{bmatrix}
\end{aligned}\]</div>
<p>因为 <span class="arithmatex">\(\nabla^2f\)</span> 正定，所以 <span class="arithmatex">\(f\)</span> 是（强）凸函数.</p>
<p>取 <span class="arithmatex">\(x^0=[1,1]\)</span> ，计算：</p>
<div class="arithmatex">\[x^1=x^0-(\nabla^2f)^{-1}\nabla f(x^0)= \begin{bmatrix}x_1 \\ x_2\end{bmatrix}-\begin{bmatrix}x_1 \\ x_2\end{bmatrix}=0\]</div>
<p>并且此时 <span class="arithmatex">\(\nabla f=0\)</span> ，所以 <span class="arithmatex">\([0,0]\)</span> 是最优解.</p>
<p>下面用带步长的 Newton 方法求解：</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">多元函数 Newton 法</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>
</code></pre></div></td></tr></table></div>
<p>收敛性分析：</p>
<div class="arithmatex">\[\lvert \frac{\partial^3{f}}{\partial{x_i}\partial{x_j}\partial{x_l}}\rvert\leq M\]</div>
<h4 id="_19">共轭梯度法<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h4>
<p>共轭梯度法中，每一次迭代的方向都与之前的方向共轭，并且，对于 <span class="arithmatex">\(\mathbb{R}^n\)</span> 上的无约束严格凸二次优化问题，可以证明至多经过 <span class="arithmatex">\(n+1\)</span> 次迭代就会收敛.</p>
<p>设 <span class="arithmatex">\(d_1,d_2\in \mathbb{R}^n,d_1,d_2\neq0\)</span> ， <span class="arithmatex">\(G\)</span> 为 <span class="arithmatex">\(n\)</span> 阶对称正定阵，称 <span class="arithmatex">\(d_1,d_2\)</span> 是 <span class="arithmatex">\(G\)</span> 共轭的，如果 <span class="arithmatex">\(d_1^TGd_2=0\)</span> ，特别地，当 <span class="arithmatex">\(G=I\)</span> 时，称 <span class="arithmatex">\(d_1,d_2\)</span> 正交.</p>
<div class="admonition note">
<p class="admonition-title">如果 <span class="arithmatex">\(d_1,\cdots,d_n\in \mathbb{R}^n\)</span> 两两 <span class="arithmatex">\(G\)</span> 共轭，则其线性无关.</p>
<p>证明：对于任意的 <span class="arithmatex">\(\sum\limits_{i=1}^{n}\alpha_id_i=0\)</span> ，左乘 <span class="arithmatex">\(d_j^TG\)</span> ，由 <span class="arithmatex">\(G\)</span> 共轭可得 <span class="arithmatex">\(\alpha_jd_j^TGd_j=0,1\leq j\leq n\)</span> ，由 <span class="arithmatex">\(G\)</span> 正定并且 <span class="arithmatex">\(d_j\neq0\)</span> 可得 <span class="arithmatex">\(\alpha_j=0,\forall 1\leq j\leq n\)</span> . 所以 <span class="arithmatex">\(d_1,\cdots,d_n\)</span> 线性无关.</p>
</div>
<p>给定一组共轭方向 <span class="arithmatex">\(d_1,\cdots,d_n\)</span> ，可以据此进行梯度下降法.</p>
<p><strong>共轭方向法</strong>：</p>
<ol>
<li>初始化 <span class="arithmatex">\(x_1,k\leftarrow 1\)</span> ；</li>
<li>当 <span class="arithmatex">\(\nabla f(x_k)\neq 0\)</span> 时：精确搜索 <span class="arithmatex">\(\alpha_k=\arg\min f(x_k+\alpha d_k)\)</span> ， <span class="arithmatex">\(x_{k+1}\leftarrow x_k+\alpha_kd_k,k\leftarrow k+1\)</span> ；</li>
</ol>
<p>下面来说明共轭方向法求解严格二次凸函数时的良好性质：最多进行 <span class="arithmatex">\(n\)</span> 次迭代（使用 <span class="arithmatex">\(n\)</span> 次共轭方向）之后收敛. 为证明这点，根据凸函数的性质以及 <span class="arithmatex">\(\mathbb{R}^n\)</span> 为凸集，只需要说明经过 <span class="arithmatex">\(n\)</span> 次迭代之后一定有 <span class="arithmatex">\(\nabla f=0\)</span> ，为此不妨设 <span class="arithmatex">\(\nabla f(x_k)\neq 0,\forall 1\leq k\leq n\)</span> ，进而证明 <span class="arithmatex">\(d_{i}^T\nabla f(x_{n+1}),\forall 1\leq k\leq n\)</span> ，利用 <span class="arithmatex">\(d_i,1\leq i\leq n\)</span> 线性无关得到结论.</p>
<div class="admonition note">
<p class="admonition-title">📍 若在 <span class="arithmatex">\(\mathbb{R}^n\)</span> 中有一组共轭方向 <span class="arithmatex">\(d_1,\cdots,d_n\)</span> ，可以证明共轭方向法至多经过 <span class="arithmatex">\(n\)</span> 步之后 <span class="arithmatex">\(\frac{1}{2}x^TGx+b^Tx\)</span> 就会收敛，其中 <span class="arithmatex">\(G\)</span> 为对称正定矩阵. <span class="arithmatex">\(\frac{1}{2}x^TGx+b^Tx\)</span> 称为严格二次凸函数.</p>
<p>不妨假设 <span class="arithmatex">\(k\leq n\)</span> 时， <span class="arithmatex">\(\nabla f(x_k)\neq 0\)</span> （迭代了 <span class="arithmatex">\(n-1\)</span> 步仍然不收敛.）</p>
<div class="arithmatex">\[\begin{aligned}
&amp;f(x)=\frac{1}{2}x^TGx+b^Tx\\
&amp;\nabla f(x)=Gx+b\\
&amp;\nabla f(x_{k+1})=\nabla f(x_k+\alpha_k d_k)=\nabla f(x_k)+\alpha_kGd_k\\
&amp;\alpha_k=\arg\min f(x_k+\alpha d_k)\rightarrow \nabla f(x_{k+1})d_k^T=0
\end{aligned}\]</div>
<p>下面试图证明 <span class="arithmatex">\(d_k^T\nabla f(x_{n+1})=0,\forall 1\leq k\leq n\)</span> ，从而可以证明 <span class="arithmatex">\(\nabla f(x_{n+1})=0\)</span> .</p>
<p>考虑：</p>
<div class="arithmatex">\[\nabla f(x_{n+1})=\nabla f(x_n)+\alpha_nGd_n=\nabla f(x_{k+1})+\sum\limits_{l=k+1}^{n}\alpha_lGd_l\]</div>
<p>进而：</p>
<div class="arithmatex">\[d_k^T\nabla f(x_{n+1})=0,\forall 1\leq k\leq n-1\]</div>
<p>并且： <span class="arithmatex">\(d_n^T \nabla f(x_{n+1})=0\)</span> ，所以 <span class="arithmatex">\(\nabla f(x_{n+1})=0\)</span> ，因为 <span class="arithmatex">\(d_i,i=1,\cdots,n\)</span> 线性无关.  </p>
</div>
<p>下面讨论如何获取共轭方向，对于严格凸二次函数 <span class="arithmatex">\(f(x)=\frac{1}{2}x^TGx-b^Tx\)</span> .</p>
<p>采取“生成”的方法：令 <span class="arithmatex">\(d_{k+1}=-\nabla f(x_{k+1})+\beta_kd_k\)</span> ，现在来反推 <span class="arithmatex">\(\beta_k\)</span> ，然后通过精确搜索得到的步长 <span class="arithmatex">\(\alpha_k\)</span> .</p>
<p>取初始点 <span class="arithmatex">\(x_1\)</span> ， <span class="arithmatex">\(d_1\leftarrow -\nabla f(x_1)=-G_1x_1+b\)</span> .</p>
<p>一般地有：</p>
<div class="arithmatex">\[d_k^TGd_{k+1}=d_k^TG(-\nabla f(x_{k+1}+\beta_kd_k))=-d_k^TG\nabla f(x_{k+1})+\beta_k d_k^TGd_k=0\]</div>
<p>得到： <span class="arithmatex">\(\beta_k=\frac{d_k^TG\nabla f(x_{k+1})}{d_k^TGd_k}\)</span> ，所以 <span class="arithmatex">\(d_{k+1}=-\nabla f(x_{k+1})+\frac{d_k^TG\nabla f(x_{k+1})}{d_k^TGd_k}d_k\)</span> .</p>
<p>精确搜索 <span class="arithmatex">\(\alpha_k\)</span> ： </p>
<div class="arithmatex">\[d_k^T\nabla f(x_k+\alpha_kd_k)=d_k^T(Gx_k+\alpha_kGd_k-b)=d_k^T\nabla f(x_k)+\alpha_kd_k^TGd_k=0\]</div>
<p>从而 <span class="arithmatex">\(\alpha_k=-d_k^T \nabla f(x_k)/d_k^TGd_k\)</span> .</p>
<p>记 <span class="arithmatex">\(\nabla f(x_k)=\gamma_k\)</span> ，注意到</p>
<div class="arithmatex">\[d_k^T\gamma_k=(-\nabla f(x_k)+\beta_{k-1}d_{k-1})^T\gamma_k=-\gamma_k^T\gamma_k,\forall k\geq 2\]</div>
<p>（其中 <span class="arithmatex">\(d_{k-1}^T\gamma_k=0\)</span> 是精确搜索得到的.）并且 <span class="arithmatex">\(d_1^T\gamma_1=-\gamma_1^T\gamma_1\)</span> .</p>
<p>因此，可以写作： <span class="arithmatex">\(\alpha_k=\frac{\gamma_k^T\gamma_k}{d_k^TGd_k}\)</span> ， <span class="arithmatex">\(\beta_k=d_k^TG\nabla f(x_{k+1})/d_k^TGd_k\)</span> .</p>
<p>上面只说明了 <span class="arithmatex">\(d_{k+1}\)</span> 和 <span class="arithmatex">\(d_k\)</span> ， <span class="arithmatex">\(G\)</span> 共轭.</p>
<div class="admonition note">
<p class="admonition-title">上述算法生成的 <span class="arithmatex">\(d_1,\cdots,d_n\)</span> 是共轭的. #imcomplete-lack-proofs</p>
<p>用归纳法解决. 只需要证明对于任意的 <span class="arithmatex">\(2\leq k\leq n\)</span> ，对于任意的 <span class="arithmatex">\(i\leq k\)</span> 有 <span class="arithmatex">\(d_i^TGd_k=0\)</span> .</p>
</div>
<p>因此由之前的讨论可以得到下面的结论：</p>
<div class="admonition note">
<p class="admonition-title">用 FR 共轭梯度法求解无约束严格凸二次规划 <span class="arithmatex">\(\min\frac{1}{2}x^TGx-b^Tx\)</span> ，至多 <span class="arithmatex">\(n\)</span> 步一定得到最优解. 其中 <span class="arithmatex">\(G\sim s^{</ins>(n)\)</span> .</p>
</div>
<p>上述算法被称为 <strong>Fletch-Reeves （FR）共轭梯度法</strong>.</p>
<ol>
<li>初始 <span class="arithmatex">\(x_1\)</span> ， <span class="arithmatex">\(\gamma_1\leftarrow Gx_1-b,d_1\leftarrow -\gamma_1,k\leftarrow 1\)</span> ；</li>
<li>当 <span class="arithmatex">\(\gamma_k\neq 0\)</span> 时进行如下更新：</li>
</ol>
<div class="arithmatex">\[\begin{aligned}
&amp;\alpha_k\leftarrow\gamma_k^T\gamma_k/d_k^TGd_k\\
&amp;x_{k+1}\leftarrow x_k+\alpha_kd_k\\
&amp;\gamma_{k+1}\leftarrow \gamma_k+\alpha_kGd_k\\
&amp;\beta_k\leftarrow d_k^TG\gamma_{k+1}/d_k^TGd_k\\
&amp;d_{k+1}\leftarrow -\gamma_{k+1}+\beta_k d_k
\end{aligned}\]</div>
<div class="admonition example">
<p class="admonition-title">用共轭梯度法求解下面的问题： <span class="arithmatex">\(\min_{x\in \mathbb{R}^2}\ f(x)=x_1^2+x_2^2-4x_1-5x_2-x_1x_2-5\)</span> .</p>
</div>
<p>直接考虑 <span class="arithmatex">\(f=x_1^2+x_2^2-4x_1-5x_2-x_1x_2\)</span> .</p>
<div class="arithmatex">\[\begin{aligned}
&amp;f(x)=\frac{1}{2}x^TGx-b^Tx\\
&amp;G=\begin{bmatrix}2 &amp; -1 \\ -1&amp;2\end{bmatrix}\quad  b=\begin{bmatrix}4  \\ 5\end{bmatrix}
\end{aligned}\]</div>
<p>初始化 <span class="arithmatex">\(x_1=\begin{bmatrix}1  \\  2\end{bmatrix}\)</span> ，则 <span class="arithmatex">\(\gamma_1=\begin{bmatrix}-4  \\ -2\end{bmatrix}\)</span> ， <span class="arithmatex">\(d=\begin{bmatrix}4  \\ 2\end{bmatrix}\)</span> .</p>
<p><span class="arithmatex">\(\gamma\neq 0\)</span> ，计算得到 <span class="arithmatex">\(\alpha_1=\frac{5}{6}\)</span> ， <span class="arithmatex">\(x_2=x+\alpha d=\begin{bmatrix}\frac{13}{3} \\  \frac{11}{3}\end{bmatrix}\)</span> ， <span class="arithmatex">\(\gamma_2=\begin{bmatrix}1 \\ -2\end{bmatrix}\)</span> ， <span class="arithmatex">\(\beta_1=\frac{1}{4}\)</span> ， <span class="arithmatex">\(d_2=\begin{bmatrix}0  \\ \frac{5}{2}\end{bmatrix}\)</span> .</p>
<p><span class="arithmatex">\(\gamma\neq 0\)</span> ，计算得到 <span class="arithmatex">\(\alpha_2=\frac{2}{5}\)</span> ， <span class="arithmatex">\(x_3=x_2+\alpha_2d=\begin{bmatrix}\frac{13}{3} \\ \frac{14}{3}\end{bmatrix}\)</span> ， <span class="arithmatex">\(\gamma_3=\begin{bmatrix}0 \\ 0\end{bmatrix}\)</span> ， <span class="arithmatex">\(\beta_2=0\)</span> ， <span class="arithmatex">\(d_3=\begin{bmatrix}0 \\ 0\end{bmatrix}\)</span> .</p>
<p>此时 <span class="arithmatex">\(\gamma=0\)</span> ，算法终止，最优解为： <span class="arithmatex">\(\begin{bmatrix}\frac{13}{3} \\ \frac{14}{3}\end{bmatrix}\)</span> . 此时 <span class="arithmatex">\(\min f=\frac{-76}{3}\)</span> .</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">FR 共轭梯度法</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">FR</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;FR 共轭梯度法&quot;&quot;&quot;</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">b</span>
    <span class="n">d</span> <span class="o">=</span> <span class="o">-</span><span class="n">gamma</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">gamma</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>
        <span class="n">d</span> <span class="o">=</span> <span class="o">-</span><span class="n">gamma</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">d</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha: &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="s1">&#39;x: &#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>\
             <span class="s1">&#39;gamma: &#39;</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="s1">&#39;beta: &#39;</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="s1">&#39;d: &#39;</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">count</span>

<span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">],</span> 
              <span class="p">[</span><span class="mi">5</span><span class="p">]])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">2</span><span class="p">]])</span>

<span class="n">FR</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">b</span> <span class="p">,</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>[[2422We120801]]</p>
<p>程序输出：</p>
<div class="collapse-code"><input checked="checked" id="__collapse5" name="__collapse5" type="checkbox" /><div class="highlight"><pre><span></span><code>alpha:  0.8333333333333334 x:  [[4.33333333]
 [3.66666667]] gamma:  [[ 1.]
 [-2.]] beta:  0.25 d:  [[0. ]
 [2.5]]
alpha:  0.4 x:  [[4.33333333]
 [4.66666667]] gamma:  [[0.]
 [0.]] beta:  0.0 d:  [[0.]
 [0.]]
[[𝟺.𝟹𝟹𝟹𝟹𝟹𝟹𝟹𝟹] [𝟺.𝟼𝟼𝟼𝟼𝟼𝟼𝟼𝟽]]
</code></pre></div>
<div class="code-footer"><label class="expand" for="__collapse5" tabindex="0" title="展"></label><label class="collapse" for="__collapse5" tabindex="0" title="折"></label></div>
</div>
<p>取 <span class="arithmatex">\(G\)</span> 为 Hilbert 矩阵， <span class="arithmatex">\(b=[1,1,\cdots,1]^T\)</span> ，初始点为 <span class="arithmatex">\(x_0=0\)</span> 取维数 <span class="arithmatex">\(n=5,8,12,20\)</span> ，记录每次使得误差小于 <span class="arithmatex">\(10^{-6}\)</span> 的迭代次数.</p>
<p>终止条件为 <span class="arithmatex">\(\lVert \gamma\rVert_2\leq 10^{-6}\)</span> .</p>
<p>代码如下：</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">FR 共轭梯度法迭代次数</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">linalg</span> <span class="k">as</span> <span class="n">LA</span>

<span class="n">ep</span> <span class="o">=</span> <span class="mf">1e-6</span> <span class="c1"># 精确度</span>
<span class="n">n_dim_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">hilmat</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;生成 Hilbert 矩阵&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[[</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">b</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">FR</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;FR 共轭梯度法&quot;&quot;&quot;</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">b</span>
    <span class="n">d</span> <span class="o">=</span> <span class="o">-</span><span class="n">gamma</span>
    <span class="c1"># 采取 L-2 范数</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="p">(</span><span class="n">LA</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">ep</span><span class="p">):</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">gamma</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>
        <span class="n">d</span> <span class="o">=</span> <span class="o">-</span><span class="n">gamma</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">d</span>
        <span class="c1"># print(&#39;alpha: &#39;, alpha, &#39;x: &#39;, x,\</span>
        <span class="c1">#     &#39;gamma: &#39;, gamma, &#39;beta: &#39;, beta, &#39;d: &#39;, d)</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">count</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n_dim_list</span><span class="p">:</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hilmat</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">count</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">FR</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;迭代次数: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;结果：</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>返回结果：</p>
<div class="collapse-code"><input checked="checked" id="__collapse6" name="__collapse6" type="checkbox" /><div class="highlight"><pre><span></span><code>迭代次数:<span class="w"> </span>
<span class="w"> </span><span class="m">6</span><span class="w"> </span>
<span class="w"> </span>结果：
<span class="w"> </span><span class="o">[[</span><span class="w">    </span><span class="m">5</span>.00000021<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span>-120.0000001<span class="w"> </span><span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w">  </span><span class="m">629</span>.99999985<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-1120.00000016<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w">  </span><span class="m">629</span>.99999985<span class="o">]]</span><span class="w"> </span>

迭代次数:<span class="w"> </span>
<span class="w"> </span><span class="m">26</span><span class="w"> </span>
<span class="w"> </span>结果：
<span class="w"> </span><span class="o">[[</span>-8.00130020e+00<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">5</span>.04071378e+02<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-7.56095143e+03<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">4</span>.62052387e+04<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-1.38614311e+05<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">2</span>.16236500e+05<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-1.68182744e+05<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">5</span>.14841978e+04<span class="o">]]</span><span class="w"> </span>

迭代次数:<span class="w"> </span>
<span class="w"> </span><span class="m">309</span><span class="w"> </span>
<span class="w"> </span>结果：
<span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="m">8</span>.46115026e+00<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-9.67277295e+02<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">2</span>.66031031e+04<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-3.05707186e+05<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">1</span>.79936600e+06<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-5.87836224e+06<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">1</span>.05367413e+07<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-8.21501978e+06<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-3.37319416e+06<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">1</span>.21633461e+07<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-9.14671830e+06<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">2</span>.39402896e+06<span class="o">]]</span><span class="w"> </span>

迭代次数:<span class="w"> </span>
<span class="w"> </span><span class="m">196</span><span class="w"> </span>
<span class="w"> </span>结果：
<span class="w"> </span><span class="o">[[</span>-1.09112145e+01<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">1</span>.04606664e+03<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-2.38661253e+04<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">2</span>.19739467e+05<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-9.62832640e+05<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">1</span>.98576169e+06<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-1.25054640e+06<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-1.34104042e+06<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">8</span>.82105153e+05<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">1</span>.68565661e+06<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">3</span>.87555790e+05<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-1.30420795e+06<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-1.70882582e+06<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-5.27666626e+05<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">1</span>.20779165e+06<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">2</span>.00142866e+06<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">9</span>.43916373e+05<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-1.43324323e+06<span class="o">]</span>
<span class="w"> </span><span class="o">[</span>-2.64951603e+06<span class="o">]</span>
<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="m">1</span>.88695398e+06<span class="o">]]</span>
</code></pre></div>
<div class="code-footer"><label class="expand" for="__collapse6" tabindex="0" title="展"></label><label class="collapse" for="__collapse6" tabindex="0" title="折"></label></div>
</div>
<p><span class="arithmatex">\(n=5,8,12,20\)</span> 每一次的迭代次数为 <span class="arithmatex">\(6,26,309,196\)</span> ，对应达到精确度的最优解如上.</p>
<h4 id="newton_1">拟 Newton 法<a class="headerlink" href="#newton_1" title="Permanent link">&para;</a></h4>
<p>Newton 法：</p>
<div class="arithmatex">\[x_{k+1}=x_k-(\nabla^2f(x_k))^{-1}\nabla f(x_k)\]</div>
<p>终点在于如何求解 <span class="arithmatex">\(\nabla^2f(x_k)^{-1}\)</span> .</p>
<p>拟 Newton 法用一个更容易求得的 <span class="arithmatex">\(n\)</span> 阶方阵 <span class="arithmatex">\(H_k\)</span> 代替 <span class="arithmatex">\(\nabla^2f(x_k)^{-1}\)</span> .</p>
<h5 id="dfr">DFR 算法<a class="headerlink" href="#dfr" title="Permanent link">&para;</a></h5>
<div class="arithmatex">\[\begin{aligned}
&amp;\nabla f(x)\approx \nabla f(x_k)+\nabla^2f(x_k)(x-x_k)\\
&amp;\nabla f(x_{k-1})\approx \nabla f(x_k)+\nabla^2f(x_k)(x_{k-1}-x_k)\\
&amp;x_{k-1}-x_k\approx \nabla^2f(x_k)^{-1}(\nabla f(x_{k-1})-\nabla f(x_k))
\end{aligned}\]</div>
<p>现在用一个 <span class="arithmatex">\(n\)</span> 阶矩阵 <span class="arithmatex">\(H_k\)</span> 替代上式，得到一个等式：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;x_{k-1}-x_k=H_k(\nabla f(x_{k-1})-\nabla f(x_k))\\
&amp;s_{k-1}=H_ky_{k-1}
\end{aligned}\]</div>
<p>称为<strong>拟 Newton 方程</strong>，下面讨论 <span class="arithmatex">\(H_k\)</span> 的具体形式.</p>
<p>设 <span class="arithmatex">\(H_k=H_{k-1}+E_k\)</span> ，从而：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;s_{k-1}=H_{k-1}y_{k-1}+E_ky_{k-1}\\
&amp;E_ky_{k-1}=s_{k-1}-H_{k-1}y_{k-1}
\end{aligned}\]</div>
<p>设 <span class="arithmatex">\(E_k\)</span> 为一个秩为 <span class="arithmatex">\(2\)</span> 的矩阵，其可以被表示为：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;E_k=\alpha_kuu^T+\beta_kvv^T\\
&amp;\alpha_kuu^Ty_{k-1}+\beta_kvv^Ty_{k-1}\overset{结合律}{=}\alpha_k(u^Ty_{k-1})u+\beta_k(v^Ty_{k-1})v\\
&amp;=s_{k-1}-H_{k-1}y_{k-1}
\end{aligned}\]</div>
<p>然后令：</p>
<div class="arithmatex">\[\left\{\begin{aligned}
&amp;\alpha_k(u^Ty_{k-1})=1\\
&amp;u=s_{k-1}
\end{aligned}\right.\quad\left\{\begin{aligned}
&amp;\beta_k(v^Ty_{k-1})=-1\\
&amp;v=H_{k-1}y_{k-1}
\end{aligned}\right.\]</div>
<p>进而得到：</p>
<div class="arithmatex">\[E_k=\frac{s_{k-1}s^T_{k-1}}{s_{k-1}^Ty_{k-1}}-\frac{H_{k-1}y_{k-1}y^T_{k-1}H_{k-1}}{y^T_{k-1}H_{k-1}y_{k-1}}\]</div>
<p>DFR 算法如下：</p>
<p>对于 <span class="arithmatex">\(\min_{x\in \mathbb{R}}\ f(x),\quad f\in C^2(\mathbb{R})\)</span> .</p>
<ol>
<li>初始化 <span class="arithmatex">\(x_0\)</span> 和对称正定阵 <span class="arithmatex">\(H_0\)</span> （通常取 <span class="arithmatex">\(E\)</span> ）， <span class="arithmatex">\(d_0\leftarrow -H_0\nabla f(x_0),k\leftarrow 0\)</span> ；</li>
<li>当 <span class="arithmatex">\(\nabla f(x_0)\neq 0\)</span> 时：由一维精确搜索确定 <span class="arithmatex">\(\alpha_k\)</span> ，更新 <span class="arithmatex">\(x_{k+1}\leftarrow x_k+\alpha_kd_k\)</span> ， <span class="arithmatex">\(s_k\leftarrow x_{k+1}-x_k\)</span> ， <span class="arithmatex">\(y_k\leftarrow \nabla f(x_{k+1})-\nabla f(x_k)\)</span> ， <span class="arithmatex">\(H_{k+1}\leftarrow H_k+\frac{s_ks_k^T}{s_k^Ty_{k}}-\frac{H_{k}y_{k}y_{k}^TH_{k}}{y_{k}^TH_{k}y_{k}}\)</span> ， <span class="arithmatex">\(d_{k+1}\leftarrow -H_{k+1}\nabla f(x_{k+1})\)</span> ， <span class="arithmatex">\(k\leftarrow k+1\)</span> ；</li>
</ol>
<p>称 <span class="arithmatex">\(H_k\)</span> 为 DFP 校正矩阵.</p>
<p>其中 <span class="arithmatex">\(\alpha_k\)</span> 通常由求解方程： <span class="arithmatex">\(d_k^T\nabla f(x_k+\alpha d_k)=0\)</span> 得到，或者写作（以二元为例）：</p>
<div class="admonition note">
<p class="admonition-title">由精确搜索步长的 DFP 算法产生的矩阵序列 <span class="arithmatex">\(\{H_k\}_k\)</span> 对称正定.</p>
</div>
<p>算法实现（以二元函数为例）：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x_1, x_2, alpha&#39;</span><span class="p">)</span>

<span class="n">f_tar</span> <span class="o">=</span> 
<span class="n">varphi_tar</span> <span class="o">=</span> 

<span class="n">f</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span> <span class="o">=</span> <span class="n">f_tar</span>
<span class="n">nabla_f</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">varphi</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">d_1</span><span class="p">,</span> <span class="n">d_2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">=</span> <span class="n">varphi_tar</span>

<span class="c1"># 用符号运算求解精确搜索得到的 alpha 的表达式</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">varphi_tar</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">solution_dict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">alpha_search</span><span class="p">(</span><span class="n">d_1</span><span class="p">,</span> <span class="n">d_2</span><span class="p">,</span> <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">alpha</span><span class="p">]</span>

<span class="c1"># 初始化</span>
<span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="o">-</span> <span class="n">H</span> <span class="o">*</span> <span class="n">matrix</span><span class="p">(</span><span class="n">nabla_f</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">d_1</span><span class="p">,</span> <span class="n">d_2</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">DFR</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">d_1</span><span class="p">,</span> <span class="n">d_2</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nabla_f</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">))</span> <span class="o">!=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha_search</span><span class="p">(</span><span class="n">d_1</span><span class="p">,</span> <span class="n">d_2</span><span class="p">,</span> <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">nabla_f</span><span class="p">(</span><span class="n">x_1</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d_1</span><span class="p">,</span> <span class="n">x_2</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d_2</span><span class="p">)</span> <span class="o">-</span> <span class="n">nabla_f</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span> <span class="o">=</span> <span class="n">x_1</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d_1</span><span class="p">,</span> <span class="n">x_2</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d_2</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">H</span> <span class="o">+</span> <span class="n">s</span> <span class="o">*</span> <span class="n">s</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">H</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">H</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">H</span> <span class="o">*</span> <span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="o">-</span> <span class="n">H</span> <span class="o">*</span> <span class="n">matrix</span><span class="p">(</span><span class="n">nabla_f</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">d_1</span><span class="p">,</span> <span class="n">d_2</span> <span class="o">=</span> <span class="n">d_1</span><span class="p">,</span> <span class="n">d_2</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span>
</code></pre></div></td></tr></table></div>
<div class="admonition example">
<p class="admonition-title">用 DFP 方法求解 <span class="arithmatex">\(\min\quad \frac{3}{2}x_1^2+\frac{1}{2}x_2^2-x_1x_2-2x_1\)</span> . 取 <span class="arithmatex">\(x_0=[-2,4]^T,H_0=E_2\)</span> .</p>
</div>
<p>解：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;f(x)=\frac{1}{2}x^TGx-bx\\
&amp;\nabla f(x)=Gx-b
\end{aligned}\]</div>
<p>精确搜索步长：</p>
<div class="arithmatex">\[d_k^T\nabla f(x_k+\alpha d_k)=d_k^T(Gx_k+)\]</div>
<p>DFR 法不要求一定精确搜索，所以可以采用下面的方法：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">linalg</span> <span class="k">as</span> <span class="n">LA</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x_1, x_2, alpha, d_1, d_2&#39;</span><span class="p">)</span>
<span class="n">f_tar</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_1</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="n">x_1</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x_2</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">x_2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="n">nabla_f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>

<span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="o">-</span> <span class="n">H</span> <span class="o">*</span> <span class="n">matrix</span><span class="p">(</span><span class="n">nabla_f</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">d_1</span><span class="p">,</span> <span class="n">d_2</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ep</span> <span class="o">=</span> <span class="mf">1e-6</span> <span class="c1"># 精确度</span>

<span class="k">def</span> <span class="nf">DFR</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">d_1</span><span class="p">,</span> <span class="n">d_2</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">d</span><span class="p">):</span>
    <span class="c1"># while not (np.array(nabla_f(x_1, x_2)) == 0).all():</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">LA</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nabla_f</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)))</span> <span class="o">&lt;</span> <span class="n">ep</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1e-2</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">nabla_f</span><span class="p">(</span><span class="n">x_1</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d_1</span><span class="p">,</span> <span class="n">x_2</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d_2</span><span class="p">)</span> <span class="o">-</span> <span class="n">nabla_f</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span> <span class="o">=</span> <span class="n">x_1</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d_1</span><span class="p">,</span> <span class="n">x_2</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d_2</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">H</span> <span class="o">+</span> <span class="n">s</span> <span class="o">*</span> <span class="n">s</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">H</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">H</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">H</span> <span class="o">*</span> <span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="o">-</span> <span class="n">H</span> <span class="o">*</span> <span class="n">matrix</span><span class="p">(</span><span class="n">nabla_f</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">d_1</span><span class="p">,</span> <span class="n">d_2</span> <span class="o">=</span> <span class="n">d_1</span><span class="p">,</span> <span class="n">d_2</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span>

<span class="n">DFR</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">d_1</span><span class="p">,</span> <span class="n">d_2</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>程序返回结果：</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span><span class="m">2</span>.00000033869402,−0.999999638356904<span class="o">)</span>
</code></pre></div>
<p>约为 <span class="arithmatex">\([2,-1]\)</span> .</p>
<div class="admonition example">
<p class="admonition-title">分别用共轭梯度法和拟 Newton 法极小化 Powell 奇异函数： <span class="arithmatex">\(f(x)=(x_1+10x_2)^2+5(x_3-x_4)^2+(x_2-2x_3)^4+10(x_1-x_4)^4\)</span> ，取 <span class="arithmatex">\(x_0=[3,-1,0,1]^T\)</span> ，已知该函数的极小值点为 <span class="arithmatex">\(x^*=[0,0,0,0]^T\)</span> .</p>
</div>
<div class="admonition example">
<p class="admonition-title">在 DFP 校正公式中, 令 <span class="arithmatex">\(A_k=\frac{s_ks_k^T}{s_k^Ty_k},B_k=-\frac{H_ky_ky_k^TH_k}{_k^TH_ky_k}\)</span> ，设初始矩阵 <span class="arithmatex">\(H_0\)</span> 对称正定， <span class="arithmatex">\(\nabla f(x_k)\neq 0,k=0,1,\cdots,n-1\)</span> ，证明算法用于求解 <span class="arithmatex">\(\min\quad \frac{1}{2}x^TAx+b^Tx+c\)</span> 时有： <span class="arithmatex">\(\sum\limits_{k=0}^{n-1}A_k=A^{-1},\sum\limits_{k=0}^{n-1}B_k=-H_0\)</span> .</p>
</div>
<h3 id="_20">信赖域方法<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h3>
<p>对于：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;\min_{x\in \mathbb{R}}\quad f(x)\\
\end{aligned}\]</div>
<p>之前的无约束优化算法都采取两个步骤： 1) 确定下降方向 <span class="arithmatex">\(d_k\)</span> ；2) 确定步长 <span class="arithmatex">\(\alpha_k\)</span> ；</p>
<p>信赖域方法直接求解 <span class="arithmatex">\(m_k=d_k\alpha_k\)</span> . 类似于牛顿法，信赖域方法首先对于优化函数 <span class="arithmatex">\(f\)</span> 在 <span class="arithmatex">\(x_k\)</span> 的局部用一个函数 <span class="arithmatex">\(q(s)=f(x_k+s)\)</span> 进行近似，然后直接求解 <span class="arithmatex">\(q_k(s)\)</span> 在局部的优化步 <span class="arithmatex">\(m_k\)</span> ，作为 <span class="arithmatex">\(f\)</span> 的优化步，这一过程需要解决两个问题：</p>
<ol>
<li>如何确定有效的局部以近似函数 <span class="arithmatex">\(f\)</span> （更新信赖域）；</li>
<li>如何求解 <span class="arithmatex">\(q(s)\)</span> 在信赖域内的优化步（求解子问题）.</li>
</ol>
<p>通常，用二元函数近似 <span class="arithmatex">\(f\)</span> ，得到该优化问题的<strong>子问题</strong>：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;\min\quad q_k(s)=f(x_k)+\nabla f(x_k)^Ts+\frac{1}{2}s^TB_ks\\
&amp;s.t.\quad \ \lVert s\rVert\leq \Delta_k
\end{aligned}\]</div>
<p><span class="arithmatex">\(\lVert \cdot\rVert\)</span> 为某范数， <span class="arithmatex">\(\Omega_k=\{x_k+s:\lVert s\rVert\leq \Delta_k\}\)</span> 称为 <span class="arithmatex">\(x_k\)</span> 的<strong>信赖域</strong>， <span class="arithmatex">\(\Delta_k\)</span> 则称为信赖域的半径； <span class="arithmatex">\(B_k\)</span> 为 Hesse 矩阵或者对 Hesse 矩阵的近似.</p>
<p>为了确定有效的信赖域，需要确定在该信赖域中作出的优化是否有效，假设 <span class="arithmatex">\(x_{k+1}=x_k+s_k\)</span> ，定义下降比值：</p>
<div class="arithmatex">\[r_k=\frac{f(x_k)-f(x_{k+1})}{q_k(0)-q(s_k)}\]</div>
<p>如果 <span class="arithmatex">\(r_k\leq 0\)</span> ，说明 <span class="arithmatex">\(f(x_k)\leq f(x_{k+1})\)</span> ，无效优化，因此应当拒绝 <span class="arithmatex">\(s_k\)</span> 并缩小信赖域半径以更近似 <span class="arithmatex">\(f\)</span> ；如果 <span class="arithmatex">\(r_k\)</span> 足够大，则应当适当增加信赖域的半径，加快优化.</p>
<p>信赖域算法如下：</p>
<ol>
<li>初始化 <span class="arithmatex">\(x_0\)</span> ，信赖域的上界 <span class="arithmatex">\(\Delta_{\max}\)</span> ，初始化 <span class="arithmatex">\(\Delta_0\in(0,\Delta_{\max}),k\leftarrow0\)</span> ，此外设置如下超参数：精确率 <span class="arithmatex">\(\epsilon\)</span> ，下降比值的两个接受度 <span class="arithmatex">\(\eta_1,\eta_ 2:0&lt;\eta_1\leq \eta_2&lt;1\)</span> ，信赖域半径改动的两个缩放系数： <span class="arithmatex">\(0&lt;\gamma_1&lt;1&lt;\gamma_k\)</span> ；</li>
<li>当 <span class="arithmatex">\(\lVert \Delta f(x_k)\rVert&gt;\epsilon\)</span> 时：</li>
</ol>
<p>求解子问题：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;\min\quad q_k(s)=f(x_k)+\nabla f(x_k)^Ts+\frac{1}{2}s^TB_ks\\
&amp;s.t.\quad \ \lVert s\rVert\leq \Delta_k
\end{aligned}\]</div>
<p>得到 <span class="arithmatex">\(s_k\)</span> ；</p>
<p>计算 <span class="arithmatex">\(r_k=\frac{f(x_k)-f(x_k+s_k)}{q(0)-q(s_k)}\)</span> .</p>
<div class="arithmatex">\[x_{k+1}\leftarrow \left\{\begin{aligned}
&amp;x_k+s_k\quad r_k\ge \eta_1\\
&amp;x_k,\quad r_k&lt;\eta_1
\end{aligned}\right.\]</div>
<p>随后改进信赖域半径：</p>
<div class="arithmatex">\[\Delta_{k+1}\leftarrow \left\{\begin{aligned}
&amp;\gamma_1\Delta_k,\quad r_k&lt;\eta_1\\
&amp;\Delta_k,\quad r_k\in[\eta_1,\eta_2)\\
&amp;\min\{\gamma_2\Delta_k,\Delta_{\max}\}
\end{aligned}\right.\]</div>
<p>注：这里可以灵活取更改方案；</p>
<p>更新 <span class="arithmatex">\(q_{k+1}(s)\)</span> ， <span class="arithmatex">\(k\leftarrow k+1\)</span> .</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="n">x</span> <span class="o">=</span> 
<span class="n">delta_max</span> <span class="o">=</span> 
<span class="n">delta</span> <span class="o">=</span> 
<span class="n">eta_1</span><span class="p">,</span> <span class="n">eta_2</span> <span class="o">=</span> 
<span class="n">gamma_1</span><span class="p">,</span> <span class="n">gamma_2</span> <span class="o">=</span> 

<span class="k">while</span> <span class="p">(</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">):</span>
    <span class="c1"># 求解优化步， q 为优化函数</span>
    <span class="n">q</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">solve_sub</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">delta_max</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">s</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">q</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">q</span><span class="p">(</span><span class="n">s_k</span><span class="p">))</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&gt;=</span> <span class="n">eta_1</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">s</span>
    <span class="c1"># 更新信赖域半径</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="n">eta_1</span><span class="p">):</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="n">gamma_1</span> <span class="o">*</span> <span class="n">delta</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&gt;</span> <span class="n">eta_2</span><span class="p">):</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">gamma_2</span> <span class="o">*</span> <span class="n">delta</span><span class="p">,</span> <span class="n">delta_max</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>下面解决如何求解信赖域子问题：</p>
<p>定义 <strong>Cauchy 点</strong> <span class="arithmatex">\(s_k^c=-\tau_k\frac{\Delta_k}{\lVert \nabla(f(x_k))\rVert}\nabla f(x_k)\)</span> .</p>
<p>其中：</p>
<div class="arithmatex">\[\tau_k=\left\{\begin{aligned}
&amp;1,\quad \nabla f(x_k)^TB\nabla f(x_k)\le0\\
&amp;\min\left\{\frac{\lVert \nabla f(x_k)\rVert^3}{\Delta_k\nabla f(x_k)B_kg_k},1\right\},\quad \text{otherwise}
\end{aligned}\right.\]</div>
<p>也称据此得到的 <span class="arithmatex">\(x_k^c\)</span> 为 Cauchy 点.</p>
<p>定义 <strong>Newton 点</strong> <span class="arithmatex">\(s_k^N\)</span> ，由 Newton 方法的求解得到的点，也称据此得到的 <span class="arithmatex">\(x_k^N\)</span> 为 Newton 点.</p>
<p><strong>折线法</strong>利用一条折线近似 <span class="arithmatex">\(s\)</span> ：连接 Cauchy 点和 Newton 点，设其连线与信赖域的边界 <span class="arithmatex">\(\partial{\Omega}\)</span> 的交点为 <span class="arithmatex">\(x_{k+1}\)</span> .</p>
<p>经过分析得到 [[2422Tu092507]] ：</p>
<div class="arithmatex">\[x_{k+1}=\left\{\begin{aligned}
&amp;x_k-\frac{\Delta_k}{\lVert g_k\rVert_2}g_k,\quad \lVert s_k^c\rVert\ge \Delta_k\\
&amp;x_k+s_k^c+\lambda(s_k^N-s_k^c),\quad \lVert s_k^c\rVert&lt;\Delta_k,\lVert s_k^N\rVert&gt;\Delta_k\\
&amp;x_k-B_k^{-1}g_k,\quad \lVert s_k^c\rVert&lt;\Delta_k,\lVert s_k^N\rVert\leq \Delta_k
\end{aligned}\right.\]</div>
<p>其中 Cauchy 步： </p>
<div class="arithmatex">\[s_k^c=-\frac{g_k^Tg_k}{g_k^TB_kg_k}g_k\]</div>
<p>Newton 步：</p>
<div class="arithmatex">\[s_k^N=-B_k^{-1}g_k\]</div>
<p><span class="arithmatex">\(\lambda\)</span> 由：</p>
<div class="arithmatex">\[\lVert s_k^c+\lambda(s_k^N-s_k^c)\rVert=\Delta_k\]</div>
<p>求解得到.</p>
<p>将信赖域迭代中产生的点</p>
<div class="admonition example">
<p class="admonition-title">函数 <span class="arithmatex">\(f(x)=10(x_1-x_1^2)^2+(1-x_1)^2\)</span> ，画出二次模型 <span class="arithmatex">\(q^{(k)}(s)=f(x)+\nabla f(x)^T+\frac{1}{2}s^TBs\)</span> 在 <span class="arithmatex">\(x=(0,-1)\)</span> 的轮廓线，其中 <span class="arithmatex">\(B\)</span> 为 <span class="arithmatex">\(f\)</span> 的 Hesse 阵，绘制子问题的轮廓，其中信赖域半径从 <span class="arithmatex">\(\Delta=0\)</span> 到 <span class="arithmatex">\(\Delta=2\)</span> ，对 <span class="arithmatex">\(x=(0,0.5)\)</span> 重复上述过程.</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">_</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s2">&quot;x_1, x_2&quot;</span><span class="p">)</span>
<span class="n">f_expr</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_1</span> <span class="o">-</span> <span class="n">x_2</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x_1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="n">f_nabla_expr</span> <span class="o">=</span> <span class="n">f_expr</span><span class="o">.</span><span class="n">gradient</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p>对于 <span class="arithmatex">\(x=(0,0.5)\)</span> ，得到子问题中的优化函数：</p>
<div class="arithmatex">\[{\left(11 \, s_{1} - 10\, s_{2}\right)} s_{1} + 20 \, {\left(-0.5\, s_{1} + 0.75\, s_{2}\right)} s_{2} - 7\, s_{1} + 5\, s_{2} + 1.625\]</div>
<p>采取折线法求解最有界并绘制解集，所选取的信赖域从 <span class="arithmatex">\(\Delta=0\)</span> 到 <span class="arithmatex">\(\Delta=2\)</span> ，绘制 <span class="arithmatex">\(100\)</span> 个点.</p>
<p>信赖域为：</p>
<div class="arithmatex">\[s_1^2+(s_2-0.5)^2\leq \Delta,\Delta\in(0,2]\]</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">linalg</span> <span class="k">as</span> <span class="n">LA</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">q_expr</span> <span class="o">=</span> 
<span class="n">x_1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x_2</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">q</span><span class="p">(</span><span class="n">s_1</span><span class="p">,</span> <span class="n">s_2</span><span class="p">)</span> <span class="o">=</span> 
<span class="n">delta_max_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">solve_sub</span><span class="p">(</span><span class="n">f_grad</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">delta_max</span><span class="p">):</span>
    <span class="n">s_c</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">f_grad</span> <span class="o">*</span> <span class="n">f_grad</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">f_grad</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">B</span> <span class="o">*</span> <span class="n">f_grad</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span>
    <span class="n">s_n</span> <span class="o">=</span> <span class="o">-</span> <span class="n">B</span><span class="o">^-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">g</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">LA</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">s_c</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">delta_max</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="o">-</span> <span class="n">delta_max</span> <span class="o">/</span> <span class="n">LA</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">s_c</span><span class="p">)</span> <span class="o">*</span> <span class="n">f_grad</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">LA</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">s_c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">delta_max</span> <span class="o">&amp;</span> <span class="n">LA</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">s_n</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">delta_max</span><span class="p">):</span>
        <span class="n">lam</span> <span class="o">=</span> <span class="p">(</span><span class="n">delta_max</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">s_c</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">s_n</span> <span class="o">-</span> <span class="n">s_c</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s_c</span> <span class="o">+</span> <span class="n">lam</span> <span class="o">*</span> <span class="p">(</span><span class="n">s_n</span> <span class="o">-</span> <span class="n">s_c</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">LA</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">s_c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">delta_max</span> <span class="o">&amp;</span> <span class="n">LA</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">s_n</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">delta_max</span><span class="p">):</span>
        <span class="n">lam</span> <span class="o">=</span> <span class="o">-</span> <span class="n">G</span><span class="o">^-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">f_grad</span>
    <span class="k">return</span> <span class="n">s</span>

<span class="n">x_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">delta_max</span> <span class="ow">in</span> <span class="n">delta_max_list</span><span class="p">:</span>
    <span class="n">x_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span> <span class="o">+</span> <span class="n">solve_sub</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span> <span class="o">+</span> <span class="n">solve_sub</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_list</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h4 id="_21">信赖域算法收敛性分析<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h4>
<p>[[2422Mo194928]]</p>
<h2 id="_22">无约束问题测试函数<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h2>
<h3 id="rosenbrock">Rosenbrock<a class="headerlink" href="#rosenbrock" title="Permanent link">&para;</a></h3>
<div class="arithmatex">\[f(x)=100(x_2-x_1^2)^2+(1-x_1)^2\]</div>
<h3 id="_23">立方体函数<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h3>
<div class="arithmatex">\[f(x)=100(x_2-x_1^3)^2+(1-x_1)^2\]</div>
<h3 id="_24">三角函数<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h3>
<div class="arithmatex">\[f(x)=\sum\limits_{i=1}^{n}\left[n+i(1-\cos x_i)-\sin x_i-\sum\limits_{j=1}^{n}\cos x_j\right]\]</div>
<h4 id="rosenbrock-n2">求解 Rosenbrock, 立方体函数, 三角函数（ <span class="arithmatex">\(n=2\)</span> 情形）<a class="headerlink" href="#rosenbrock-n2" title="Permanent link">&para;</a></h4>
<p>选择了 P 121 的 1, 5, 6 三个函数进行计算.</p>
<p>采用了信赖域算法和拟 Newton 算法，实践中发现前者收敛很快，后者跑的时间较长（全部输出结果可见 HTML）</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">_</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s2">&quot;x_1, x_2, s_1, s_2&quot;</span><span class="p">)</span>

<span class="n">rb_expr</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_2</span> <span class="o">-</span> <span class="n">x_1</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x_1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="n">cube_expr</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_2</span> <span class="o">-</span> <span class="n">x_1</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x_1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="n">tri_expr</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">x_1</span><span class="p">))</span> <span class="o">-</span> <span class="n">sin</span><span class="p">(</span><span class="n">x_1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x_1</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">x_2</span><span class="p">)))</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">x_2</span><span class="p">))</span> <span class="o">-</span> <span class="n">sin</span><span class="p">(</span><span class="n">x_2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x_1</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">x_2</span><span class="p">)))</span><span class="o">^</span><span class="mi">2</span>

<span class="k">def</span> <span class="nf">get_g_h</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;计算梯度、Hessian 矩阵&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">gradient</span><span class="p">(),</span> <span class="n">expr</span><span class="o">.</span><span class="n">hessian</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h3 id="_25">信赖域算法求解<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h3>
<p>重构了之前的函数以适用于一般的二元情形.</p>
<div class="collapse-code"><input checked="checked" id="__collapse7" name="__collapse7" type="checkbox" /><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># 信赖域方法</span>
<span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.5</span> <span class="c1"># 初始值</span>
<span class="c1"># x = matrix([[x_1, x_2]]).transpose()</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-5</span> <span class="c1"># 精确度</span>
<span class="n">delta_max</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">delta</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">eta_1</span><span class="p">,</span> <span class="n">eta_2</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span>
<span class="n">gamma_1</span><span class="p">,</span> <span class="n">gamma_2</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="n">s_1</span><span class="p">,</span> <span class="n">s_2</span><span class="p">]])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">trust_region</span><span class="p">(</span><span class="n">f_expr</span><span class="p">,</span> <span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="n">delta</span><span class="p">):</span>
    <span class="c1"># 首先用符号运算处理后续进行计算得到后续运算用到的函数</span>
    <span class="n">f</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span> <span class="o">=</span> <span class="n">f_expr</span>
    <span class="n">f_grad_expr</span><span class="p">,</span> <span class="n">f_hess_expr</span> <span class="o">=</span> <span class="n">get_g_h</span><span class="p">(</span><span class="n">f_expr</span><span class="p">)</span>
    <span class="n">f_grad</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">f_grad_expr</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">f_hess</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">f_hess_expr</span><span class="p">)</span>
    <span class="n">q</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">s_1</span><span class="p">,</span> <span class="n">s_2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">f_expr</span> <span class="o">+</span> <span class="n">matrix</span><span class="p">(</span><span class="n">f_grad_expr</span><span class="p">)</span> <span class="o">*</span> <span class="n">s</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">f_hess_expr</span> <span class="o">*</span> <span class="n">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">f_grad_val</span> <span class="o">=</span> <span class="n">f_grad</span><span class="p">(</span><span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span><span class="p">)</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="p">(</span><span class="n">LA</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">f_grad_val</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">):</span>
        <span class="c1"># 求解优化步， 以 Hess 近似二阶正定矩阵</span>
        <span class="n">f_grad_val</span> <span class="o">=</span> <span class="n">f_grad</span><span class="p">(</span><span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span><span class="p">)</span>
        <span class="n">f_hess_val</span> <span class="o">=</span> <span class="n">f_hess</span><span class="p">(</span><span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span><span class="p">)</span>
        <span class="n">s_val</span> <span class="o">=</span> <span class="n">solve_sub</span><span class="p">(</span><span class="n">f_grad_val</span><span class="p">,</span> <span class="n">f_hess_val</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
        <span class="n">s_1_val</span><span class="p">,</span> <span class="n">s_2_val</span> <span class="o">=</span> <span class="n">s_val</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">s_val</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">q_</span><span class="p">(</span><span class="n">s_1</span><span class="p">,</span> <span class="n">s_2</span><span class="p">)</span> <span class="o">=</span> <span class="n">q</span><span class="p">(</span><span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x_1_val</span> <span class="o">+</span> <span class="n">s_1_val</span><span class="p">,</span> <span class="n">x_2_val</span> <span class="o">+</span> <span class="n">s_2_val</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">q_</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">q_</span><span class="p">(</span><span class="n">s_1_val</span><span class="p">,</span> <span class="n">s_2_val</span><span class="p">))</span>

        <span class="c1"># 更新</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&gt;=</span> <span class="n">eta_1</span><span class="p">):</span>
            <span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span> <span class="o">=</span> <span class="n">x_1_val</span> <span class="o">+</span> <span class="n">s_1_val</span><span class="p">,</span> <span class="n">x_2_val</span> <span class="o">+</span> <span class="n">s_2_val</span>

        <span class="c1"># 更新信赖域半径</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="n">eta_1</span><span class="p">):</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">gamma_1</span> <span class="o">*</span> <span class="n">delta</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">r</span> <span class="o">&gt;=</span> <span class="n">eta_2</span><span class="p">):</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">gamma_2</span> <span class="o">*</span> <span class="n">delta</span><span class="p">,</span> <span class="n">delta_max</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span>
</code></pre></div></td></tr></table></div>
<div class="code-footer"><label class="expand" for="__collapse7" tabindex="0" title="展"></label><label class="collapse" for="__collapse7" tabindex="0" title="折"></label></div>
</div>
<p>求解立方体函数：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">trust_region</span><span class="p">(</span><span class="n">cube_expr</span><span class="p">,</span> <span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>求解 Rosenbrock</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">trust_region</span><span class="p">(</span><span class="n">rb_expr</span><span class="p">,</span> <span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>求解三角函数：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">trust_region</span><span class="p">(</span><span class="n">tri_expr</span><span class="p">,</span> <span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="newton_2">拟 Newton 法<a class="headerlink" href="#newton_2" title="Permanent link">&para;</a></h3>
<p>重构了之前的函数以适用于一般情形：</p>
<div class="collapse-code"><input checked="checked" id="__collapse8" name="__collapse8" type="checkbox" /><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># 拟 Newton 法</span>
<span class="k">def</span> <span class="nf">DFR</span><span class="p">(</span><span class="n">f_expr</span><span class="p">,</span> <span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">):</span>
    <span class="n">f</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span> <span class="o">=</span> <span class="n">f_expr</span>
    <span class="n">f_grad_expr</span><span class="p">,</span> <span class="n">f_hess_expr</span> <span class="o">=</span> <span class="n">get_g_h</span><span class="p">(</span><span class="n">f_expr</span><span class="p">)</span>
    <span class="n">f_grad</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">f_grad_expr</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">f_hess</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">f_hess_expr</span><span class="p">)</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="o">-</span> <span class="n">H</span> <span class="o">*</span> <span class="n">f_grad</span><span class="p">(</span><span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span><span class="p">)</span>
    <span class="n">d_1</span><span class="p">,</span> <span class="n">d_2</span> <span class="o">=</span> <span class="n">d_1</span><span class="p">,</span> <span class="n">d_2</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">while</span> <span class="ow">not</span> <span class="n">LA</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">f_grad</span><span class="p">(</span><span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span><span class="p">)))</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">f_grad</span><span class="p">(</span><span class="n">x_1_val</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d_1</span><span class="p">,</span> <span class="n">x_2_val</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d_2</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_grad</span><span class="p">(</span><span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span><span class="p">))</span>
        <span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span> <span class="o">=</span> <span class="n">x_1_val</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d_1</span><span class="p">,</span> <span class="n">x_2_val</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">d_2</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">H</span> <span class="o">+</span> <span class="n">s</span> <span class="o">*</span> <span class="n">s</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">H</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">H</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">H</span> <span class="o">*</span> <span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="o">-</span> <span class="n">H</span> <span class="o">*</span> <span class="n">f_grad</span><span class="p">(</span><span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span><span class="p">)</span>
        <span class="n">d_1</span><span class="p">,</span> <span class="n">d_2</span> <span class="o">=</span> <span class="n">d_1</span><span class="p">,</span> <span class="n">d_2</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x_1_val</span><span class="p">,</span> <span class="n">x_2_val</span>
</code></pre></div></td></tr></table></div>
<div class="code-footer"><label class="expand" for="__collapse8" tabindex="0" title="展"></label><label class="collapse" for="__collapse8" tabindex="0" title="折"></label></div>
</div>
<p>三种函数计算如下，结果和信赖域算法基本一样，输出结果很长故略去，具体计算迭代步的输出见 HTML 文件.</p>
<h2 id="_26">约束优化<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h2>
<p>讨论无约束优化问题：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;\min\quad f(x)\\
&amp;s.t.\quad \ c_i(x)=0,i=1,\cdots,m\\
&amp;\qquad\quad c_j(x)\ge0,j=m+1,\cdots,p
\end{aligned}\]</div>
<p>记可行域为 <span class="arithmatex">\(F\)</span> .</p>
<p>称 <span class="arithmatex">\(s\in \mathbb{R}^m\)</span> 为 <span class="arithmatex">\(x\in \mathbb{R}^m\)</span> 处<strong>下降方向</strong>，如果存在 <span class="arithmatex">\(\delta&gt;0\)</span> ，使得对于任意的 <span class="arithmatex">\(\alpha\in(0,\delta)\)</span> 都有 <span class="arithmatex">\(f(x+\alpha s)&lt;f(x)\)</span> .</p>
<details class="note">
<summary>设 <span class="arithmatex">\(f\)</span> 在 <span class="arithmatex">\(x\)</span> 处连续可微. 若 <span class="arithmatex">\(s\)</span> 满足 <span class="arithmatex">\(\nabla f^Ts&lt;0\)</span> ，则 <span class="arithmatex">\(s\)</span> 是 <span class="arithmatex">\(f\)</span> 在 <span class="arithmatex">\(x\)</span> 处的一个下降方向.</summary>
<p>证明：</p>
<div class="arithmatex">\[f(x+\alpha s)=f(x)+\nabla f(x)^T\alpha s+\mathcal{o}(\alpha)\]</div>
<p>则当 <span class="arithmatex">\(\alpha&gt;0\)</span> 充分小时 <span class="arithmatex">\(f(x+\alpha s)&lt;f(x)\)</span> .</p>
</details>
<p>设 <span class="arithmatex">\(x\in F\)</span> ， <span class="arithmatex">\(s\neq0\in \mathbb{R}^m\)</span> ，如果存在 <span class="arithmatex">\(\delta&gt;0\)</span> 使得对于任意的 <span class="arithmatex">\(\alpha\in(0,\delta],x+\alpha s\in F\)</span> ，则称 <span class="arithmatex">\(s\)</span> 为 <span class="arithmatex">\(x\)</span> 处的一个<strong>可行方向</strong>，记 <span class="arithmatex">\(x\)</span> 处可行方向全体为 <span class="arithmatex">\(FD(x)\)</span> .</p>
<p>定义减弱的可行方向：称 <span class="arithmatex">\(s\neq 0\in \mathbb{R}^m\)</span> 是<strong>序列化可行方向</strong>，如果存在 <span class="arithmatex">\(\mathbb{R}^m\)</span> 上的序列 <span class="arithmatex">\(\{s_k\}_{k\ge1}\)</span> 和 <span class="arithmatex">\(\{\delta_k\}_{k\ge1},\delta_k&gt;0\)</span> 满足 <span class="arithmatex">\(\{x+\delta_ks_k\}_{k\ge1}\subset F\)</span> 并且 <span class="arithmatex">\(f(x+\delta_ks_k)&lt;f(x)\)</span> ，以及 <span class="arithmatex">\(s_k\rightarrow s(k\rightarrow \infty),\delta_k\rightarrow0\)</span> . 并记序列可行化方向全体为 <span class="arithmatex">\(SFD(x)\)</span> .</p>
<p>设 <span class="arithmatex">\(x\in F,s\neq 0\in \mathbb{R}^n\)</span> ，如果 <span class="arithmatex">\(s\)</span> 还满足以下条件：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;s^T\nabla c_i(x)=0,i=1,\cdots,m\\
&amp;s^T\nabla c_i(x)\ge0,i=m+1,\cdots,p
\end{aligned}\]</div>
<p>则称 <span class="arithmatex">\(s\)</span> 为可行域 <span class="arithmatex">\(F\)</span> 在 <span class="arithmatex">\(x\)</span> 处的<strong>约束线性化后的可行方向</strong>，记 <span class="arithmatex">\(x\)</span> 处约束线性化后的可行方向为 <span class="arithmatex">\(LFD(x)\)</span> . 约束线性化即为：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;c_i(x+\alpha s)=c_i(x)+\alpha s^T\nabla c_i(x)+\mathcal{o}(\alpha)=\mathcal{o}(\alpha)\rightarrow0\\
&amp;c_i(x+\alpha s)=c_i(x)+\alpha s^T\nabla c_i(x)+\mathcal{o}(\alpha)\ge0(\alpha\rightarrow0)\\
\end{aligned}\]</div>
<details class="note">
<summary>对于 <span class="arithmatex">\(x\in F\)</span> ，在其上定义的方向全体 <span class="arithmatex">\(D,FD,SFD,LFD\)</span> 均为锥.</summary>
<p>证明： <span class="arithmatex">\(s\in D\)</span> ，设对应的为 <span class="arithmatex">\(\delta&gt;0\)</span> ，对于 <span class="arithmatex">\(t&gt;0\)</span> ，取 <span class="arithmatex">\(\delta'=\frac{\delta}{t}\)</span> 即可. <span class="arithmatex">\(s\in FD\)</span> 同理. 对于 <span class="arithmatex">\(s\in SFD,t&gt;0\)</span> ，取 <span class="arithmatex">\(\{ts_k\}_{k\ge1}\)</span> 和 <span class="arithmatex">\(\{\delta_k/t\}_{k\ge1}\)</span> . 对于 <span class="arithmatex">\(LFD\)</span> 显然.</p>
</details>
<p>对于上面定义的各种方向集，其关系如下：</p>
<div class="admonition note">
<p class="admonition-title">若约束函数在 <span class="arithmatex">\(x\in F\)</span> 处连续可微，则 <span class="arithmatex">\(FD(x)\subset SFD(x)\subset LFD(x)\)</span> .</p>
</div>
<div class="admonition note">
<p class="admonition-title">若 <span class="arithmatex">\(x\)</span> 为约束优化问题的局部最优解，并且 <span class="arithmatex">\(f,c_i,i=1,\cdots,p\)</span> 连续可微，那么 <span class="arithmatex">\(SFD(x)\cap LFD(x)=\emptyset\)</span> ，于是 <span class="arithmatex">\(FD(x)\cap LFD(x)=\emptyset\)</span> .</p>
</div>
<div class="admonition note">
<p class="admonition-title">约束函数 <span class="arithmatex">\(c_i\)</span> 在 <span class="arithmatex">\(x\in F\)</span> 处连续可微，且 <span class="arithmatex">\(c_i\)</span> 为线性函数 ( <span class="arithmatex">\(i=1,\cdots,p\)</span> ) 或者 <span class="arithmatex">\(\nabla c_i(x),i=1,\cdots,m\)</span> 线性无关，则 <span class="arithmatex">\(FD(x)=LFD(x)\)</span> ，从而 <span class="arithmatex">\(FD(x)=SFD(x)=LFD(x)\)</span> .</p>
</div>
<h3 id="lagrange">Lagrange 对偶问题<a class="headerlink" href="#lagrange" title="Permanent link">&para;</a></h3>
<p>对于约束优化问题，定义其 <strong>Lagrange 函数</strong>：</p>
<div class="arithmatex">\[L(x,\lambda,\mu)=f(x)-\sum\limits_{i=1}^{m}\mu_ic_i(x)-\sum\limits_{i=m+1}^{p}\lambda_ic_i(x)\]</div>
<div class="admonition example">
<p class="admonition-title">线性规划的对偶问题.</p>
<div class="arithmatex">\[(D)\quad \begin{aligned}
&amp;\max\quad b^Ty\\
&amp;s.t.\quad\ A^Ty\leq c
\end{aligned}\]</div>
</div>
<h3 id="kt">KT 算法<a class="headerlink" href="#kt" title="Permanent link">&para;</a></h3>
<p>定义 <strong>Lagrange 乘子</strong> <span class="arithmatex">\(\lambda_i,i=1,\cdots,p\)</span> ，如果其满足下面的约束条件：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;\nabla f(x)-\sum\limits_{i=1}^{p}\lambda_i\nabla c_i(x)=0\\
&amp;\lambda_i\ge0,i=m+1,\cdots,p\\
&amp;\lambda_ic_i(x)=0,i=m+1,\cdots,p
\end{aligned}\]</div>
<p>称上述约束条件为 <strong>KT 条件</strong>（KKT 条件）.</p>
<div class="admonition tip">
<p class="admonition-title">Lagrange 乘子由原约束优化问题中的不等式约束确定.</p>
</div>
<p>关于 Lagrange 乘子的存在性有如下定理：</p>
<div class="admonition note">
<p class="admonition-title">设 <span class="arithmatex">\(x\in F\)</span> 为约束无优化问题的一个局部最优解，如果 <span class="arithmatex">\(f,c_i,i=1,\cdots,p\)</span> 在 <span class="arithmatex">\(x\)</span> 的某邻域内连续可微，并且 <span class="arithmatex">\(SFD(x)=LFD(x)\)</span> ，则存在该约束无优化问题的 Lagrange 乘子.</p>
</div>
<p>同时， <span class="arithmatex">\(KT\)</span> 条件是 <span class="arithmatex">\(x\in F\)</span> 是约束优化问题的<u>局部</u>最优解的必要条件. </p>
<details class="example">
<summary>考虑问题 <span class="arithmatex">\(\min\ (x_2+100)^2+0.01x_1^2,s.t.x_2-\cos x_1\ge 0\)</span> ，其局部解是有限的还是无限的？用 KT 条件证明结论.</summary>
<p>Hint：KT 条件，若 <span class="arithmatex">\(\lambda=0\)</span> ，则 <span class="arithmatex">\([x_1,x_2]=[0,1]\)</span> ，若 <span class="arithmatex">\(\lambda&gt;0\)</span> ，则最后需要求解： <span class="arithmatex">\(0.02x_1=\sin 2x_1+200\sin x_1\)</span> ，这个等式只有有限个解.</p>
</details>
<p>特别地，满足以下情形时 <span class="arithmatex">\(x\)</span> 为全局最优解. </p>
<div class="admonition note">
<p class="admonition-title">如果 <span class="arithmatex">\(f,-c_i,i=m+1,m+2,\cdots,p\)</span> 为连续可微的凸函数. <span class="arithmatex">\(c_j,j=1,\cdots,m\)</span> 为线性函数. 如果 <span class="arithmatex">\(x\)</span> 满足 <span class="arithmatex">\(KT\)</span> 条件，则 <span class="arithmatex">\(x\)</span> 为约束优化问题的全局最优解.</p>
</div>
<div class="admonition note">
<p class="admonition-title">若 <span class="arithmatex">\(f,-c_i,i=m+1,m+2,\cdots,p\)</span> 是连续可微的凸函数， <span class="arithmatex">\(c_j,i=1,\cdots,m\)</span> 是线性函数. 若 <span class="arithmatex">\(x^*\)</span> 满足 KT 条件，则 <span class="arithmatex">\(x^*\)</span> 是优化问题的整体最优解.</p>
</div>
<p>解该二次规划问题，并作图解释其集合意义.</p>
<div class="arithmatex">\[\begin{aligned}
&amp;\max\quad f(x)=2x_1+3x_2+4x_1^2+2x_1x_2+x_2^2\\
&amp;s.t.\quad \ x_1-x_2\ge0,x_1+x_2\le4,x_1\le3
\end{aligned}\]</div>
<h3 id="_27">罚函数法<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h3>
<p><strong>罚函数法</strong>将约束优化问题转化为无约束优化问题.</p>
<p>对于等式优化问题：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;\min\quad f(x)\\
&amp;s.t.\quad\ c_i(x)=0,i=1,\cdots,m
\end{aligned}\]</div>
<p>可以定义<strong>二次罚函数</strong>：</p>
<div class="arithmatex">\[Q(x,\mu)=f(x)+\frac{1}{2\mu}\sum\limits_{i=1}^{m}c_i^2(x)\]</div>
<p>其中 <span class="arithmatex">\(\frac{1}{2\mu}\sum\limits_{i=1}^{m}c_i^2(x)\)</span> 被称为<strong>惩罚项</strong>， <span class="arithmatex">\(\mu&gt;0\)</span> .</p>
<p>如果 <span class="arithmatex">\(c_i(x)\neq 0\)</span> ，当 <span class="arithmatex">\(\mu\rightarrow \infty\)</span> 时，惩罚项 <span class="arithmatex">\(\rightarrow \infty\)</span> .</p>
<p>而对于含有不等式约束条件的约束优化问题，对 <span class="arithmatex">\(c_j(x)\ge 0\)</span> ，令 <span class="arithmatex">\(c_j'(x)=\min\{c_i(x),0\}\)</span> ，转化为求解 <span class="arithmatex">\(c_j'(x)=0\)</span> .</p>
<h3 id="_28">障碍罚函数法<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h3>
<p>考虑不等式约束优化问题： </p>
<div class="arithmatex">\[\begin{aligned} &amp;\min\quad f(x)\\ &amp;s.t.\quad\ c_i(x)\leq0,i=1,\cdots,p \end{aligned}\]</div>
<p>常用的障碍罚函数为： </p>
<p><span class="arithmatex">\(<span class="arithmatex">\(\begin{aligned}
&amp;P(x;\mu)=f(x)-\mu\sum\limits_{i=1}^{p}\ln(-c_i(x))\\
&amp;P(x;\mu)=f(x)-\mu\sum\limits_{i=1}^{p}\frac{1}{c_i(x)}\\
&amp;\mu&gt;0
\end{aligned}\)</span>\)</span></p>
<p>从而可以得到局部近似解.</p>
<p>令 <span class="arithmatex">\(\mu\rightarrow 0\)</span> 可以得到解.</p>
<div class="admonition question">
<p class="admonition-title">关于罚函数方法</p>
<p>如果最优值在接近边界的地方取到怎么办？</p>
</div>
<h3 id="_29">二次规划<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h3>
<h4 id="_30">等式约束二次规划问题<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h4>
<p>定义等式约束的 <span class="arithmatex">\(QP\)</span> 问题：</p>
<div class="arithmatex">\[\begin{aligned}
&amp;\min\quad \frac{1}{2}x^TGx+g^Tx\\
&amp;s.t.\quad\ A^Tx=b
\end{aligned}\]</div>
<p>下面介绍 Lagrange 法，其是求解该问题的 KT 条件的一种方法：</p>
<div class="arithmatex">\[\left\{\begin{aligned}
&amp;Gx+g-A\lambda=0\\
&amp;A^Tx=b
\end{aligned}\right.\Leftrightarrow \begin{bmatrix}G &amp; -A \\ -A^T &amp; 0\end{bmatrix}\begin{bmatrix}x \\ \lambda\end{bmatrix}=-\begin{bmatrix}g \\ b\end{bmatrix}\]</div>
<div class="admonition note">
<p class="admonition-title">设 <span class="arithmatex">\(A\)</span> 为列满秩的， <span class="arithmatex">\(Z\)</span> 为 <span class="arithmatex">\(A^T\)</span> 的零空间 <span class="arithmatex">\(\{p:A^Tp=0\}\)</span> 的一组基，如果 <span class="arithmatex">\(Z^TGZ\)</span> 正定，则上述 KT 条件的解 <span class="arithmatex">\(x,\lambda\)</span> 唯一，并且 <span class="arithmatex">\(x\)</span> 是原问题的解.</p>
</div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="最后更新">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年6月12日</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="创建日期">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年3月31日</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../Stat/" class="md-footer__link md-footer__link--prev" aria-label="上一页: 数理统计">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                数理统计
              </div>
            </div>
          </a>
        
        
          
          <a href="../DSA/" class="md-footer__link md-footer__link--next" aria-label="下一页: 数据结构与算法">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                数据结构与算法
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy 2024 zoeminus
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="mailto:2210377@mail.nankai.edu.cn" target="_blank" rel="noopener" title="Email" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.7l167.6-182.9c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/zoeplus" target="_blank" rel="noopener" title="Github Profile" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["revision.date", "navigation.path", "navigation.top", "navigation.footer", "toc.follow", "content.action.edit", "content.code.copy"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.bd41221c.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/copy-tex.min.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
        <script src="../../javascripts/tabSync.js"></script>
      
    
  </body>
</html>